

<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>spydr.webdriver &#8212; spydr 0.4.2 documentation</title>
    <link rel="stylesheet" href="../../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">spydr 0.4.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">spydr.webdriver</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for spydr.webdriver</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">urllib.parse</span>
<span class="kn">import</span> <span class="nn">zipfile</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">ElementClickInterceptedException</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">ElementNotInteractableException</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">InvalidSelectorException</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">NoSuchElementException</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">NoSuchFrameException</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">NoSuchWindowException</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">StaleElementReferenceException</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">TimeoutException</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">WebDriverException</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.action_chains</span> <span class="kn">import</span> <span class="n">ActionChains</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.alert</span> <span class="kn">import</span> <span class="n">Alert</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="kn">import</span> <span class="n">Keys</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.remote.webelement</span> <span class="kn">import</span> <span class="n">WebElement</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support</span> <span class="kn">import</span> <span class="n">expected_conditions</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support.ui</span> <span class="kn">import</span> <span class="n">WebDriverWait</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">strftime</span><span class="p">,</span> <span class="n">localtime</span>
<span class="kn">from</span> <span class="nn">webdriver_manager.chrome</span> <span class="kn">import</span> <span class="n">ChromeDriverManager</span>
<span class="kn">from</span> <span class="nn">webdriver_manager.firefox</span> <span class="kn">import</span> <span class="n">GeckoDriverManager</span>
<span class="kn">from</span> <span class="nn">webdriver_manager.microsoft</span> <span class="kn">import</span> <span class="n">IEDriverManager</span><span class="p">,</span> <span class="n">EdgeChromiumDriverManager</span>

<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">INI</span><span class="p">,</span> <span class="n">HOWS</span><span class="p">,</span> <span class="n">Utils</span><span class="p">,</span> <span class="n">YML</span>


<span class="c1"># Spydrify WebElement</span>
<span class="k">class</span> <span class="nc">_WebElementSpydrify</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
        <span class="nd">@wraps</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">spydr_or_element_self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">element_or_elements</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="n">spydr_or_element_self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">element_or_elements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spydrify</span><span class="p">(</span><span class="n">spydr_or_element_self</span><span class="p">,</span> <span class="n">element_or_elements</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">element_or_elements</span>
        <span class="k">return</span> <span class="n">wrapper</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_spydrify</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">spydr_or_element_self</span><span class="p">,</span> <span class="n">element_or_elements</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">element_or_elements</span><span class="p">,</span> <span class="n">WebElement</span><span class="p">):</span>
            <span class="n">element_or_elements</span> <span class="o">=</span> <span class="n">SpydrElement</span><span class="p">(</span><span class="n">spydr_or_element_self</span><span class="p">,</span> <span class="n">element_or_elements</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">element_or_elements</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">element_or_elements</span><span class="p">):</span>
                <span class="n">element_or_elements</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_spydrify</span><span class="p">(</span><span class="n">spydr_or_element_self</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">element_or_elements</span>


<div class="viewcode-block" id="Spydr"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr">[docs]</a><span class="k">class</span> <span class="nc">Spydr</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Spydr WebDriver</span>

<span class="sd">    Keyword Arguments:</span>
<span class="sd">        auth_username (str): Username for HTTP Basic/Digest Auth. Defaults to None.</span>
<span class="sd">        auth_password (str): Password for HTTP Basic/Digest Auth. Defaults to None.</span>
<span class="sd">        browser (str): Browser to drive. Defaults to &#39;chrome&#39;.</span>
<span class="sd">            Supported browsers: &#39;chrome&#39;, &#39;edge&#39;, &#39;firefox&#39;, &#39;ie&#39;, &#39;safari&#39;.</span>
<span class="sd">        headless (bool): Headless mode. Defaults to False.</span>
<span class="sd">        ini (str/INI): INI File. Defaults to None.</span>
<span class="sd">        locale (str): Browser locale. Defaults to &#39;en&#39;.</span>
<span class="sd">        log_indent (int): Indentation for logging messages. Defaults to 2.</span>
<span class="sd">        log_level (str): Logging level: &#39;INFO&#39; or &#39;DEBUG&#39;. Defaults to None.</span>
<span class="sd">            When set to &#39;INFO&#39;, `info()` messages will be shown.</span>
<span class="sd">            When set to &#39;DEBUG&#39;, `debug()`, `info()` and called methods will be shown.</span>
<span class="sd">        screen_root (str): The directory of saved screenshots. Defaults to &#39;./screens&#39;.</span>
<span class="sd">        timeout (int): Timeout for implicitly_wait, page_load_timeout, and script_timeout. Defaults to 30.</span>
<span class="sd">        window_size (str): The size of the window when headless. Defaults to &#39;1280,720&#39;.</span>
<span class="sd">        yml (str/bytes/os.PathLike/YML): YAML File. Defaults to None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        InvalidSelectorException: Raise an error when locator is invalid</span>
<span class="sd">        NoSuchElementException: Raise an error when no element is found</span>
<span class="sd">        WebDriverException: Raise an error when Spydr encounters an error</span>

<span class="sd">    Returns:</span>
<span class="sd">        Spydr: An instance of Spydr Webdriver</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">keys</span> <span class="o">=</span> <span class="n">Keys</span>
    <span class="sd">&quot;&quot;&quot;selenium.webdriver.common.keys.Keys: Pre-defined keys codes&quot;&quot;&quot;</span>

    <span class="n">wait</span> <span class="o">=</span> <span class="n">WebDriverWait</span>
    <span class="sd">&quot;&quot;&quot;selenium.webdriver.support.ui.WebDriverWait: WebDriverWait&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">auth_username</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">auth_password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">browser</span><span class="o">=</span><span class="s1">&#39;chrome&#39;</span><span class="p">,</span>
                 <span class="n">headless</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">ini</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">locale</span><span class="o">=</span><span class="s1">&#39;en&#39;</span><span class="p">,</span>
                 <span class="n">log_indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                 <span class="n">log_level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">screen_root</span><span class="o">=</span><span class="s1">&#39;./screens&#39;</span><span class="p">,</span>
                 <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                 <span class="n">window_size</span><span class="o">=</span><span class="s1">&#39;1280,720&#39;</span><span class="p">,</span>
                 <span class="n">yml</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auth_username</span> <span class="o">=</span> <span class="n">auth_username</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auth_password</span> <span class="o">=</span> <span class="n">auth_password</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">browser</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">headless</span> <span class="o">=</span> <span class="n">headless</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ini</span> <span class="o">=</span> <span class="n">ini</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_indent</span> <span class="o">=</span> <span class="n">log_indent</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">log_indent</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">else</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLevelName</span><span class="p">(</span><span class="n">log_level</span><span class="p">)</span> <span class="k">if</span> <span class="n">log_level</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DEBUG&#39;</span><span class="p">,</span> <span class="s1">&#39;INFO&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="mi">50</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">screen_root</span> <span class="o">=</span> <span class="n">screen_root</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="n">window_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yml</span> <span class="o">=</span> <span class="n">yml</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">locale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format_locale</span><span class="p">(</span><span class="n">locale</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_webdriver</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_logger</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span>

<div class="viewcode-block" id="Spydr.abspath"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.abspath">[docs]</a>    <span class="k">def</span> <span class="nf">abspath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">mkdir</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;abspath(filename, suffix=&#39;.png&#39;, root=os.getcwd(), mkdir=True)</span>
<span class="sd">        Resolve file to absolute path and create all directories if missing.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): File name</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            suffix (str): File suffix. Defaults to None.</span>
<span class="sd">            root (str): Root directory. Defaults to `os.getcwd()`.</span>
<span class="sd">            mkdir (bool): Create directores in the path. Defaults to True.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Absolute path of the file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Utils</span><span class="o">.</span><span class="n">to_abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span> <span class="n">mkdir</span><span class="o">=</span><span class="n">mkdir</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.actions"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.actions">[docs]</a>    <span class="k">def</span> <span class="nf">actions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize an ActionChains.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ActionChains: An instance of ActionChains</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ActionChains</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.add_class"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.add_class">[docs]</a>    <span class="k">def</span> <span class="nf">add_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">class_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add the given CSS class to the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            class_name (str): CSS class name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">add_class</span><span class="p">(</span><span class="n">class_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.add_cookie"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.add_cookie">[docs]</a>    <span class="k">def</span> <span class="nf">add_cookie</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cookie</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a cookie to your current session.</span>

<span class="sd">        Args:</span>
<span class="sd">            cookie (dict): A dictionary object.</span>
<span class="sd">                Required keys are &quot;name&quot; and &quot;value&quot;.</span>
<span class="sd">                Optional keys are &quot;path&quot;, &quot;domain&quot;, &quot;secure&quot;, and &quot;expiry&quot;.</span>

<span class="sd">        Usage:</span>
<span class="sd">            spydr.add_cookie({&#39;name&#39;: &#39;foo&#39;, &#39;value&#39;: &#39;bar&#39;})</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_cookie</span><span class="p">(</span><span class="n">cookie</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.alert_accept"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.alert_accept">[docs]</a>    <span class="k">def</span> <span class="nf">alert_accept</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Accept the alert available.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            alert (Alert): Alert instance. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alert</span><span class="p">,</span> <span class="n">Alert</span><span class="p">):</span>
            <span class="n">alert</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">switch_to_alert</span><span class="p">()</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.alert_dismiss"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.alert_dismiss">[docs]</a>    <span class="k">def</span> <span class="nf">alert_dismiss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dismiss the alert available.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            alert (Alert): Alert instance. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alert</span><span class="p">,</span> <span class="n">Alert</span><span class="p">):</span>
            <span class="n">alert</span><span class="o">.</span><span class="n">dismiss</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">switch_to_alert</span><span class="p">()</span><span class="o">.</span><span class="n">dismiss</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.alert_sendkeys"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.alert_sendkeys">[docs]</a>    <span class="k">def</span> <span class="nf">alert_sendkeys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys_to_send</span><span class="p">,</span> <span class="n">alert</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">accept</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send keys to the alert available and accept it.</span>

<span class="sd">        Args:</span>
<span class="sd">            keys_to_send (str): Text to send</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            alert (Alert): Alert instance. Defaults to None.</span>
<span class="sd">            accept (bool): Whether to accept the alert after sending keys.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">alert</span> <span class="o">=</span> <span class="n">alert</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alert</span><span class="p">,</span> <span class="n">Alert</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">switch_to_alert</span><span class="p">()</span>

        <span class="n">alert</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">keys_to_send</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">accept</span><span class="p">:</span>
            <span class="n">alert</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.alert_text"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.alert_text">[docs]</a>    <span class="k">def</span> <span class="nf">alert_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dismiss</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the text of the alert available and dismiss it.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            alert (Alert): Alert Instance. Defaults to None.</span>
<span class="sd">            dismiss (bool): Whether to dismiss the alert.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">alert</span> <span class="o">=</span> <span class="n">alert</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alert</span><span class="p">,</span> <span class="n">Alert</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">switch_to_alert</span><span class="p">()</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">alert</span><span class="o">.</span><span class="n">text</span>

        <span class="k">if</span> <span class="n">dismiss</span><span class="p">:</span>
            <span class="n">alert</span><span class="o">.</span><span class="n">dismiss</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">text</span></div>

<div class="viewcode-block" id="Spydr.back"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.back">[docs]</a>    <span class="k">def</span> <span class="nf">back</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Goes one step backward in the browser history&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">back</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.blank"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.blank">[docs]</a>    <span class="k">def</span> <span class="nf">blank</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open a blank page.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;about:blank&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.blur"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.blur">[docs]</a>    <span class="k">def</span> <span class="nf">blur</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Trigger blur event on the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">blur</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.checkbox_to_be"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.checkbox_to_be">[docs]</a>    <span class="k">def</span> <span class="nf">checkbox_to_be</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">is_checked</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the checkbox, identified by the locator, to the given state (is_checked).</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the checkbox or WebElement</span>
<span class="sd">            is_checked (bool): whether the checkbox is to be checked</span>

<span class="sd">        Raises:</span>
<span class="sd">            InvalidSelectorException: Raise an error when the element is not a checkbox</span>
<span class="sd">            WebDriverException: Raise an error when failing to set the given state</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">tag_name</span> <span class="o">!=</span> <span class="s1">&#39;input&#39;</span> <span class="ow">and</span> <span class="n">element</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;checkbox&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSelectorException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Element is not a checkbox: </span><span class="si">{</span><span class="n">locator</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">is_selected</span><span class="p">()</span> <span class="o">!=</span> <span class="n">is_checked</span> <span class="ow">and</span> <span class="n">element</span><span class="o">.</span><span class="n">is_enabled</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_checkbox_or_radio_clicked</span><span class="p">(</span><span class="n">element</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">WebDriverException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Failed to click on the element: </span><span class="si">{</span><span class="n">locator</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.checkboxes_to_be"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.checkboxes_to_be">[docs]</a>    <span class="k">def</span> <span class="nf">checkboxes_to_be</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">is_checked</span><span class="p">,</span> <span class="n">on_values</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set all checkboxes, identified by the locator, to the given state (is_checked).</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str): The locator to identify all the checkboxes</span>
<span class="sd">            is_checked (bool): whether the checkboxes are to be checked</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            on_values (list/tuple): When given, only checkboxes with values in the list are set to `is_checked`</span>
<span class="sd">                while others are set to `not is_checked`. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>
        <span class="n">on_values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">on_values</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">on_values</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">on_values</span> <span class="ow">and</span> <span class="n">element</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">on_values</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">checkbox_to_be</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="ow">not</span> <span class="n">is_checked</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">checkbox_to_be</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">is_checked</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.children"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.children">[docs]</a>    <span class="k">def</span> <span class="nf">children</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the children elements of the given element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[WebElement]: The children elements of the given element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">children</span></div>

<div class="viewcode-block" id="Spydr.clear"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clear the text of a text input element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.clear_and_send_keys"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.clear_and_send_keys">[docs]</a>    <span class="k">def</span> <span class="nf">clear_and_send_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="o">*</span><span class="n">keys</span><span class="p">,</span> <span class="n">blur</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wait_until_enabled</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clear the element first and then send the given keys.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            *keys: Any combinations of strings</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            blur (bool): Lose focus after sending keys. Defaults to False.</span>
<span class="sd">            wait_until_enabled (bool): Whether to wait until the element `is_enabled()` before clearing and sending keys. Defaults to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">clear_and_send_keys</span><span class="p">(</span><span class="o">*</span><span class="n">keys</span><span class="p">,</span> <span class="n">blur</span><span class="o">=</span><span class="n">blur</span><span class="p">,</span> <span class="n">wait_until_enabled</span><span class="o">=</span><span class="n">wait_until_enabled</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.click"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.click">[docs]</a>    <span class="k">def</span> <span class="nf">click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">switch_to_new_target</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scroll_into_view</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">behavior</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Click the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            switch_to_new_target (bool): Whether to switch to a newly-opened window after clicking. Defautls to False.</span>
<span class="sd">            scroll_into_view (bool): Whether to scroll the element into view before clicking. Defaults to False.</span>
<span class="sd">            behavior (str): Defines the transition animation for `scroll_into_view`.</span>
<span class="sd">                One of `auto` or `smooth`. Defaults to &#39;auto&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple, optional: If `switch_to_new_target`, it returns a tuple of (window_handle_before_clicking, window_handle_after_clicking)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">switch_to_new_target</span><span class="p">:</span>
            <span class="n">window_handle_before_clicking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_handle</span>
            <span class="n">num_of_windows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_handles</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_clicked</span><span class="p">(</span><span class="n">locator</span><span class="p">,</span> <span class="n">scroll_into_view</span><span class="o">=</span><span class="n">scroll_into_view</span><span class="p">,</span> <span class="n">behavior</span><span class="o">=</span><span class="n">behavior</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">switch_to_new_target</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wait_until_number_of_windows_to_be</span><span class="p">(</span><span class="n">num_of_windows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">window_handle_after_clicking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_handles</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">switch_to_window</span><span class="p">(</span><span class="n">window_handle_after_clicking</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">window_handle_before_clicking</span><span class="p">,</span> <span class="n">window_handle_after_clicking</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.click_with_offset"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.click_with_offset">[docs]</a>    <span class="k">def</span> <span class="nf">click_with_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Click the element from x and y offsets.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            x_offset (int): X offset from the left of the element. Defaults to 1.</span>
<span class="sd">            y_offset (int): Y offset from the top of the element. Defaults to 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wait_until_enabled</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">()</span><span class="o">.</span><span class="n">move_to_element_with_offset</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">x_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.close"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Close the window.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.close_all_others"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.close_all_others">[docs]</a>    <span class="k">def</span> <span class="nf">close_all_others</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Close all other windows.&quot;&quot;&quot;</span>
        <span class="n">windows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_handles</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">windows</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">current_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_handle</span>

            <span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">windows</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">window</span> <span class="o">==</span> <span class="n">current_window</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">switch_to_window</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">switch_to_window</span><span class="p">(</span><span class="n">current_window</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.closest"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.closest">[docs]</a>    <span class="k">def</span> <span class="nf">closest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">parent_locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Traverse the element, by locator, and its parents until it finds an element, by parent locator, that matches.</span>
<span class="sd">        Will return itself or the matching ancestor. (IE not supported)</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            parent_locator (str): Parent locator</span>

<span class="sd">        Returns:</span>
<span class="sd">            WebElement: WebElement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">closest</span><span class="p">(</span><span class="n">parent_locator</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.copy_and_paste"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.copy_and_paste">[docs]</a>    <span class="k">def</span> <span class="nf">copy_and_paste</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copy text to clipboard and paste it (send_keys) to the element. (Chrome only)</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            text (str): Text to paste</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">copy_and_paste</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.copy_to_clipboard"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.copy_to_clipboard">[docs]</a>    <span class="k">def</span> <span class="nf">copy_to_clipboard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copy text to clipboard. (Chrome only)</span>

<span class="sd">        Args:</span>
<span class="sd">            text (str): Text to paste</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">            let input = document.createElement(&quot;input&quot;);</span>
<span class="s1">            input.value = `$</span><span class="si">{arguments[0]}</span><span class="s1">`;</span>
<span class="s1">            input.style.position = &#39;absolute&#39;;</span>
<span class="s1">            input.style.left = &#39;-9999px&#39;;</span>
<span class="s1">            document.body.appendChild(input);</span>
<span class="s1">            input.select();</span>
<span class="s1">            document.execCommand(&quot;copy&quot;);</span>
<span class="s1">            document.body.removeChild(input);</span>
<span class="s1">        &#39;&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.css_property"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.css_property">[docs]</a>    <span class="k">def</span> <span class="nf">css_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The value of CSS property.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            name (str): CSS property name</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: CSS property value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">css_property</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.ctrl_click"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.ctrl_click">[docs]</a>    <span class="k">def</span> <span class="nf">ctrl_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ctrl-click the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">ctrl_click</span><span class="p">()</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">current_url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the URL of the current page.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: URL of the page</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">current_url</span>

<div class="viewcode-block" id="Spydr.debug"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.debug">[docs]</a>    <span class="k">def</span> <span class="nf">debug</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Log **DEBUG** messages.</span>

<span class="sd">        Args:</span>
<span class="sd">            message (str): **DEBUG** message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">message</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.delete_all_cookies"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.delete_all_cookies">[docs]</a>    <span class="k">def</span> <span class="nf">delete_all_cookies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete all cookies in the scope of the session.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">delete_all_cookies</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.delete_cookie"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.delete_cookie">[docs]</a>    <span class="k">def</span> <span class="nf">delete_cookie</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete a cookie with the given name.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): Name of the cookie</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">delete_cookie</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">desired_capabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get driver&#39;s current desired capabilities.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: A dictionary object of the current capabilities</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">desired_capabilities</span>

<div class="viewcode-block" id="Spydr.double_click"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.double_click">[docs]</a>    <span class="k">def</span> <span class="nf">double_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Double-click the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">double_click</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.double_click_with_offset"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.double_click_with_offset">[docs]</a>    <span class="k">def</span> <span class="nf">double_click_with_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Double-click the element from x and y offsets.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            x_offset (int): X offset from the left of the element. Defaults to 1.</span>
<span class="sd">            y_offset (int): Y offset from the top of the element. Defaults to 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">double_click_with_offset</span><span class="p">(</span><span class="n">x_offset</span><span class="o">=</span><span class="n">x_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">=</span><span class="n">y_offset</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.drag_and_drop"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.drag_and_drop">[docs]</a>    <span class="k">def</span> <span class="nf">drag_and_drop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_locator</span><span class="p">,</span> <span class="n">target_locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Hold down the left mouse button on the source element,</span>
<span class="sd">        then move to the target element and releases the mouse button.</span>

<span class="sd">        Args:</span>
<span class="sd">            source_locator (str/WebElement): The element to mouse down</span>
<span class="sd">            target_locator (str/WebElement): The element to mouse up</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">source_element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">source_locator</span><span class="p">)</span>
        <span class="n">target_element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">target_locator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">()</span><span class="o">.</span><span class="n">drag_and_drop</span><span class="p">(</span><span class="n">source_element</span><span class="p">,</span> <span class="n">target_element</span><span class="p">())</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.drag_and_drop_by_offset"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.drag_and_drop_by_offset">[docs]</a>    <span class="k">def</span> <span class="nf">drag_and_drop_by_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_locator</span><span class="p">,</span> <span class="n">x_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Hold down the left mouse button on the source element,</span>
<span class="sd">        then move to the target offset and releases the mouse button.</span>

<span class="sd">        Args:</span>
<span class="sd">            source_locator (str/WebElement): The element to mouse down</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            x_offset (int): X offset to move to</span>
<span class="sd">            y_offset (int): Y offset to move to</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">source_element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">source_locator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">()</span><span class="o">.</span><span class="n">drag_and_drop_by_offset</span><span class="p">(</span><span class="n">source_element</span><span class="p">,</span> <span class="n">x_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">)</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">driver</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Instance of Selenium WebDriver.</span>

<span class="sd">        Returns:</span>
<span class="sd">            WebDriver: Instance of Selenium WebDriver</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span>

    <span class="nd">@driver</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">driver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">driver_</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__driver</span> <span class="o">=</span> <span class="n">driver_</span>

<div class="viewcode-block" id="Spydr.execute_async_script"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.execute_async_script">[docs]</a>    <span class="k">def</span> <span class="nf">execute_async_script</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">script</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Asynchronously execute JavaScript in the current window or frame.</span>

<span class="sd">        Args:</span>
<span class="sd">            script (str): JavaScript to execute</span>
<span class="sd">            *args: Any applicable arguments for JavaScript</span>

<span class="sd">        Returns:</span>
<span class="sd">            Any applicable return from JavaScript</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">execute_async_script</span><span class="p">(</span><span class="n">script</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.execute_script"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.execute_script">[docs]</a>    <span class="k">def</span> <span class="nf">execute_script</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">script</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Synchronously execute JavaScript in the current window or frame.</span>

<span class="sd">        Args:</span>
<span class="sd">            script (str): JavaScript to execute</span>
<span class="sd">            *args: Any applicable arguments for JavaScript</span>

<span class="sd">        Returns:</span>
<span class="sd">            Any applicable return from JavaScript</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="n">script</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.find_element"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.find_element">[docs]</a>    <span class="nd">@_WebElementSpydrify</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">find_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Find the element by the given locator.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Raises:</span>
<span class="sd">            NoSuchElementException: Raise an error when no element found</span>

<span class="sd">        Returns:</span>
<span class="sd">            WebElement: The element found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">locator</span><span class="p">,</span> <span class="n">WebElement</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">locator</span>

        <span class="n">element</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">how</span><span class="p">,</span> <span class="n">what</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_locator</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">how</span> <span class="o">==</span> <span class="n">HOWS</span><span class="p">[</span><span class="s1">&#39;css&#39;</span><span class="p">]:</span>
            <span class="n">matched</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(.*):eq\((\d+)\)&#39;</span><span class="p">,</span> <span class="n">what</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">matched</span><span class="p">:</span>
                <span class="n">new_what</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">matched</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;css=</span><span class="si">{</span><span class="n">new_what</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)[</span><span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">)]</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">NoSuchElementException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">locator</span><span class="si">}</span><span class="s1"> does not have &quot;:eq(</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s1">)&quot; element&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">element</span><span class="p">:</span>
            <span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_located</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">WebElement</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">NoSuchElementException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot locate element in the given time using: </span><span class="si">{</span><span class="n">locator</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">element</span></div>

<div class="viewcode-block" id="Spydr.find_elements"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.find_elements">[docs]</a>    <span class="nd">@_WebElementSpydrify</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">find_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Find all elements by the given locator.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str): The locator to identify the elements or list[WebElement]</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[WebElement]: All elements found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">locator</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="n">WebElement</span><span class="p">)</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">locator</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">locator</span>

        <span class="n">how</span><span class="p">,</span> <span class="n">what</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_locator</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">how</span><span class="p">,</span> <span class="n">what</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">elements</span></div>

<div class="viewcode-block" id="Spydr.first_child"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.first_child">[docs]</a>    <span class="k">def</span> <span class="nf">first_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the first child element of the given element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Returns:</span>
<span class="sd">            WebElement: The first child element of the given element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">first_child</span></div>

<div class="viewcode-block" id="Spydr.focus"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.focus">[docs]</a>    <span class="k">def</span> <span class="nf">focus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Trigger focus event on the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">focus</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.forward"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.forward">[docs]</a>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Goes one step forward in the browser history.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.fullscreen_window"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.fullscreen_window">[docs]</a>    <span class="k">def</span> <span class="nf">fullscreen_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Invokes the window manager-specific &#39;full screen&#39; operation.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">fullscreen_window</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.get_attribute"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.get_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">get_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the given attribute or property of the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            name (str): Attribute name</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool/str/None: The attribute value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.get_cookie"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.get_cookie">[docs]</a>    <span class="k">def</span> <span class="nf">get_cookie</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the cookie by name.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The name of the cookie</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict/None: Return the cookie or None if not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">get_cookie</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.get_cookies"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.get_cookies">[docs]</a>    <span class="k">def</span> <span class="nf">get_cookies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the cookies visible in the current session.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[dict]: Return cookies in a set of dictionaries</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">get_cookies</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.get_ini_key"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.get_ini_key">[docs]</a>    <span class="k">def</span> <span class="nf">get_ini_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get value of the given key from INI.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): Key name</span>
<span class="sd">            section: INI section. Defaults to the default section.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Value (any data type JSON supports)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ini</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ini</span><span class="o">.</span><span class="n">get_key</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">section</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.get_property"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.get_property">[docs]</a>    <span class="k">def</span> <span class="nf">get_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the given property of the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            name (str): Property name</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool/dict/int/list/str/None: The property value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.get_screenshot_as_base64"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.get_screenshot_as_base64">[docs]</a>    <span class="k">def</span> <span class="nf">get_screenshot_as_base64</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a screenshot of the current window as a base64 encoded string.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Base64 encoded string of the screenshot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wait_until_page_loaded</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">get_screenshot_as_base64</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.get_screenshot_as_file"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.get_screenshot_as_file">[docs]</a>    <span class="k">def</span> <span class="nf">get_screenshot_as_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save a screenshot of the current window to filename (PNG).</span>

<span class="sd">        Default directory for saved screenshots is defined in: screen_root.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): Filename of the screenshot</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the file is saved</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wait_until_page_loaded</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">get_screenshot_as_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">screen_root</span><span class="p">))</span></div>

<div class="viewcode-block" id="Spydr.get_screenshot_as_png"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.get_screenshot_as_png">[docs]</a>    <span class="k">def</span> <span class="nf">get_screenshot_as_png</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a screenshot of the current window as a binary data.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bytes: Binary data of the screenshot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wait_until_page_loaded</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">get_screenshot_as_png</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.get_window_position"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.get_window_position">[docs]</a>    <span class="k">def</span> <span class="nf">get_window_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window_handle</span><span class="o">=</span><span class="s1">&#39;current&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the x and y position of the given window.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            window_handle (str): The handle of the window. Defaults to &#39;current&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The position of the window as dict: {&#39;x&#39;: 0, &#39;y&#39;: 0}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">get_window_position</span><span class="p">(</span><span class="n">window_handle</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.get_window_rect"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.get_window_rect">[docs]</a>    <span class="k">def</span> <span class="nf">get_window_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the x, y, height, and width of the current window.</span>

<span class="sd">        Returns:</span>
<span class="sd">           dict: The position, height, and width as dict: {&#39;x&#39;: 0, &#39;y&#39;: 0, &#39;width&#39;: 100, &#39;height&#39;: 100}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">get_window_rect</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.get_window_size"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.get_window_size">[docs]</a>    <span class="k">def</span> <span class="nf">get_window_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window_handle</span><span class="o">=</span><span class="s1">&#39;current&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the width and height of the given window.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            window_handle (str): The handle of the window. Defaults to &#39;current&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The height and width of the window as dict: {&#39;width&#39;: 100, &#39;height&#39;: 100}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">get_window_size</span><span class="p">(</span><span class="n">window_handle</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.has_attribute"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.has_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">has_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">attribute</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if the element has the given attribute.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            attribute (str): Attribute name</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the attribute exists</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">has_attribute</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.has_attribute_value"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.has_attribute_value">[docs]</a>    <span class="k">def</span> <span class="nf">has_attribute_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if the element&#39;s attribute contains the given `value`.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            attribute (str): Attribute name</span>
<span class="sd">            value (bool/str): value to check</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether value is found in the element&#39;s attribute</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">has_attribute_value</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.has_class"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.has_class">[docs]</a>    <span class="k">def</span> <span class="nf">has_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">class_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if the element has the given CSS class.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            class_name (str): CSS class name</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the CSS class exists</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">has_class</span><span class="p">(</span><span class="n">class_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.has_text"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.has_text">[docs]</a>    <span class="k">def</span> <span class="nf">has_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if the element contains the given `text`.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            text (str): Text to check</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element has the given text</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">has_text</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.hide"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.hide">[docs]</a>    <span class="k">def</span> <span class="nf">hide</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Hide the element.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.highlight"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.highlight">[docs]</a>    <span class="k">def</span> <span class="nf">highlight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">hex_color</span><span class="o">=</span><span class="s1">&#39;#ff3&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Highlight the element with the given color.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            hex_color (str, optional): Hex color. Defaults to &#39;#ff3&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">highlight</span><span class="p">(</span><span class="n">hex_color</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">implicitly_wait</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Timeout for implicitly wait.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: The timeout of implicitly wait</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__implicitly_wait</span>

    <span class="nd">@implicitly_wait</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">implicitly_wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seconds</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__implicitly_wait</span> <span class="o">=</span> <span class="n">seconds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">implicitly_wait</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>

<div class="viewcode-block" id="Spydr.info"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.info">[docs]</a>    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Log **INFO** messages.</span>

<span class="sd">        Args:</span>
<span class="sd">            message (str): **INFO** Message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">message</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ini</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;INI file as an INI instance.</span>

<span class="sd">        Returns:</span>
<span class="sd">            INI: INI instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ini</span>

    <span class="nd">@ini</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">ini</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">INI</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__ini</span> <span class="o">=</span> <span class="n">file</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__ini</span> <span class="o">=</span> <span class="n">INI</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">if</span> <span class="n">file</span> <span class="k">else</span> <span class="kc">None</span>

<div class="viewcode-block" id="Spydr.is_displayed"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.is_displayed">[docs]</a>    <span class="k">def</span> <span class="nf">is_displayed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if the element is displayed.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            seconds (int): Seconds to wait until giving up. Defaults to `self.implicitly_wait`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element is displayed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">implicitly_wait</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">implicitly_wait</span>
        <span class="n">seconds</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span> <span class="k">if</span> <span class="n">seconds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">implicitly_wait</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">implicitly_wait</span> <span class="o">=</span> <span class="n">seconds</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">is_displayed</span><span class="p">()</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">NoSuchElementException</span><span class="p">,</span> <span class="n">TimeoutException</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">implicitly_wait</span> <span class="o">=</span> <span class="n">implicitly_wait</span></div>

<div class="viewcode-block" id="Spydr.is_enabled"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.is_enabled">[docs]</a>    <span class="k">def</span> <span class="nf">is_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if the element is enabled.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element is enabled</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">is_enabled</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.is_located"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.is_located">[docs]</a>    <span class="k">def</span> <span class="nf">is_located</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if the element is located in the given seconds.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str): The locator to identify the element</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            seconds (int): Seconds to wait until giving up. Defaults to `self.implicitly_wait`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            False/WebElement: Return False if not located. Return WebElement if located.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">how</span><span class="p">,</span> <span class="n">what</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_locator</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>

        <span class="n">implicitly_wait</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">implicitly_wait</span>
        <span class="n">seconds</span> <span class="o">=</span> <span class="n">seconds</span> <span class="k">if</span> <span class="n">seconds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">implicitly_wait</span>

        <span class="k">if</span> <span class="n">seconds</span> <span class="o">!=</span> <span class="n">implicitly_wait</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">implicitly_wait</span> <span class="o">=</span> <span class="n">seconds</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="p">,</span> <span class="n">seconds</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">wd</span><span class="p">:</span> <span class="n">wd</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">how</span><span class="p">,</span> <span class="n">what</span><span class="p">))</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">NoSuchElementException</span><span class="p">,</span> <span class="n">NoSuchWindowException</span><span class="p">,</span> <span class="n">StaleElementReferenceException</span><span class="p">,</span> <span class="n">TimeoutException</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">seconds</span> <span class="o">!=</span> <span class="n">implicitly_wait</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">implicitly_wait</span> <span class="o">=</span> <span class="n">implicitly_wait</span></div>

<div class="viewcode-block" id="Spydr.is_page_loaded"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.is_page_loaded">[docs]</a>    <span class="k">def</span> <span class="nf">is_page_loaded</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if `document.readyState` is `complete`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the page is loaded</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return document.readyState == &quot;complete&quot;;&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.is_selected"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.is_selected">[docs]</a>    <span class="k">def</span> <span class="nf">is_selected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if the element is selected.</span>

<span class="sd">        Can be used to check if a checkbox or radio button is selected.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element is selected</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">is_selected</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.is_text_matched"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.is_text_matched">[docs]</a>    <span class="k">def</span> <span class="nf">is_text_matched</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Whether the given text matches the elememnt&#39;s text.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            text (str): Text to match</span>

<span class="sd">        Returns:</span>
<span class="sd">             bool: Whether the given text matches the element&#39;s text</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">is_text_matched</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.js_click"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.js_click">[docs]</a>    <span class="k">def</span> <span class="nf">js_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Call `HTMLElement.click()` using JavaScript.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">js_click</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.js_send_keys"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.js_send_keys">[docs]</a>    <span class="k">def</span> <span class="nf">js_send_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send text to the element using JavaScript.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            text (str): Text to send</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">js_send_keys</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.last_child"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.last_child">[docs]</a>    <span class="k">def</span> <span class="nf">last_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the last child element of the given element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Returns:</span>
<span class="sd">            WebElement: The last child element of the element element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">last_child</span></div>

<div class="viewcode-block" id="Spydr.load_cookies"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.load_cookies">[docs]</a>    <span class="k">def</span> <span class="nf">load_cookies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load Cookies from a JSON file.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): File name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.json&#39;</span><span class="p">,</span> <span class="n">mkdir</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">cookie_file</span><span class="p">:</span>
            <span class="n">cookies</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">cookie_file</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">cookie</span> <span class="ow">in</span> <span class="n">cookies</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_cookie</span><span class="p">(</span><span class="n">cookie</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.location"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.location">[docs]</a>    <span class="k">def</span> <span class="nf">location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The location of the element in the renderable canvas.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The location of the element as dict: {&#39;x&#39;: 0, &#39;y&#39;: 0}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">location</span></div>

<div class="viewcode-block" id="Spydr.maximize_window"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.maximize_window">[docs]</a>    <span class="k">def</span> <span class="nf">maximize_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Maximize the current window.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">headless</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">maximize_window</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.maximize_to_screen"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.maximize_to_screen">[docs]</a>    <span class="k">def</span> <span class="nf">maximize_to_screen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Maximize the current window to match the screen size.&quot;&quot;&quot;</span>
        <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return { width: window.screen.width, height: window.screen.height };&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_window_position</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_window_size</span><span class="p">(</span><span class="n">size</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">],</span> <span class="n">size</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="Spydr.minimize_window"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.minimize_window">[docs]</a>    <span class="k">def</span> <span class="nf">minimize_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Minimize the current window.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">headless</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">minimize_window</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.move_by_offset"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.move_by_offset">[docs]</a>    <span class="k">def</span> <span class="nf">move_by_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Moving the mouse to an offset from current mouse position.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            x_offset (int): X offset</span>
<span class="sd">            y_offset (int): Y offset</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">()</span><span class="o">.</span><span class="n">move_by_offset</span><span class="p">(</span><span class="n">x_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">)</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.move_to_element"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.move_to_element">[docs]</a>    <span class="k">def</span> <span class="nf">move_to_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Moving the mouse to the middle of the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">()</span><span class="o">.</span><span class="n">move_to_element</span><span class="p">(</span><span class="n">element</span><span class="p">)</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.move_to_element_with_offset"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.move_to_element_with_offset">[docs]</a>    <span class="k">def</span> <span class="nf">move_to_element_with_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Move the mouse by an offset of the specified element.</span>
<span class="sd">        Offsets are relative to the top-left corner of the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            x_offset (int): X offset. Defaults to 1.</span>
<span class="sd">            y_offset (int): Y offset. Defaults to 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">()</span><span class="o">.</span><span class="n">move_to_element_with_offset</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">x_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">)</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.next_element"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.next_element">[docs]</a>    <span class="k">def</span> <span class="nf">next_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the next element of the given element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Returns:</span>
<span class="sd">            WebElement: The next element of the given element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">next_element</span></div>

<div class="viewcode-block" id="Spydr.new_tab"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.new_tab">[docs]</a>    <span class="k">def</span> <span class="nf">new_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open a new tab.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Window handle of the new tab</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;window.open();&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_handles</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="Spydr.new_window"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.new_window">[docs]</a>    <span class="k">def</span> <span class="nf">new_window</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open a new window.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): Name of the window</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Window handle of the new window</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">            var w = Math.max(</span>
<span class="s1">                document.documentElement.clientWidth, window.innerWidth || 0</span>
<span class="s1">            );</span>
<span class="s1">            var h = Math.max(</span>
<span class="s1">                document.documentElement.clientHeight, window.innerHeight || 0</span>
<span class="s1">            );</span>
<span class="s1">            window.open(&quot;about:blank&quot;, arguments[0], `width=$</span><span class="si">{w}</span><span class="s1">,height=$</span><span class="si">{h}</span><span class="s1">`);</span>
<span class="s1">        &#39;&#39;&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_handles</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="Spydr.open"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.open">[docs]</a>    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">new_tab</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load the web page by its given URL.</span>

<span class="sd">        Args:</span>
<span class="sd">            url (str): URL of the web page</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            new_tab (bool): Whether to open in a new tab. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[str]: List of [current_window_handle, new_tab_window_handle]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">current_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_handle</span>

        <span class="k">if</span> <span class="n">new_tab</span><span class="p">:</span>
            <span class="n">new_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_tab</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">switch_to_window</span><span class="p">(</span><span class="n">new_handle</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">current_handle</span><span class="p">,</span> <span class="n">new_handle</span><span class="p">]</span> <span class="k">if</span> <span class="n">new_tab</span> <span class="k">else</span> <span class="p">[</span><span class="n">current_handle</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span></div>

<div class="viewcode-block" id="Spydr.open_data_as_url"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.open_data_as_url">[docs]</a>    <span class="k">def</span> <span class="nf">open_data_as_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">mediatype</span><span class="o">=</span><span class="s1">&#39;text/html&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use Data URL to open `data` as inline document.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (str): Data to be open as inline document</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            mediatype (str): MIME type. Defaults to &#39;text/html&#39;.</span>
<span class="sd">            encoding (str): Data encoding. Defaults to &#39;utf-8&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">base64_encoded</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">encoding</span><span class="p">))</span>
        <span class="n">base64_data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">base64_encoded</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;data:</span><span class="si">{</span><span class="n">mediatype</span><span class="si">}</span><span class="s1">;base64,</span><span class="si">{</span><span class="n">base64_data</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.open_file"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.open_file">[docs]</a>    <span class="k">def</span> <span class="nf">open_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open file with the browser.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): File name</span>

<span class="sd">        Raises:</span>
<span class="sd">            WebDriverException: Raise an error when filename is not found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">mkdir</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file_</span><span class="p">):</span>
            <span class="n">html_path</span> <span class="o">=</span> <span class="n">file_</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;file:///</span><span class="si">{</span><span class="n">html_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">WebDriverException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot find file: $</span><span class="si">{</span><span class="n">file_</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.open_file_as_url"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.open_file_as_url">[docs]</a>    <span class="k">def</span> <span class="nf">open_file_as_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">mediatype</span><span class="o">=</span><span class="s1">&#39;text/html&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use Data URL to open file content as inline document.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): File name</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            mediatype (str): MIME type. Defaults to &#39;text/html&#39;.</span>
<span class="sd">            encoding (str): File encoding. Defaults to &#39;utf-8&#39;.</span>

<span class="sd">        Raises:</span>
<span class="sd">            WebDriverException: Raise an error when filename is not found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">mkdir</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file_</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">open_data_as_url</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mediatype</span><span class="o">=</span><span class="n">mediatype</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">WebDriverException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot find file: $</span><span class="si">{</span><span class="n">file_</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.open_with_auth"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.open_with_auth">[docs]</a>    <span class="k">def</span> <span class="nf">open_with_auth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load the web page by adding username and password to the URL</span>

<span class="sd">        Args:</span>
<span class="sd">            url (str): URL of the web page</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            username (str): Username. Defaults to auth_username or None.</span>
<span class="sd">            password (str): Password. Defaults to auth_password or None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">username</span> <span class="o">=</span> <span class="n">username</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">auth_username</span>
        <span class="n">password</span> <span class="o">=</span> <span class="n">password</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">auth_password</span>

        <span class="k">if</span> <span class="n">username</span> <span class="ow">and</span> <span class="n">password</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span> <span class="o">!=</span> <span class="s1">&#39;chrome&#39;</span><span class="p">:</span>
            <span class="n">encoded_username</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
            <span class="n">encoded_password</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>

            <span class="n">split_result</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlsplit</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="n">split_result_with_auth</span> <span class="o">=</span> <span class="n">split_result</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span>
                <span class="n">netloc</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">encoded_username</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">encoded_password</span><span class="si">}</span><span class="s1">@</span><span class="si">{</span><span class="n">split_result</span><span class="o">.</span><span class="n">netloc</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="n">url_with_auth</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlunsplit</span><span class="p">(</span><span class="n">split_result_with_auth</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url_with_auth</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">page_load_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Timeout for page load</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Page load timeout</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__page_load_timeout</span>

    <span class="nd">@page_load_timeout</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">page_load_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seconds</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__page_load_timeout</span> <span class="o">=</span> <span class="n">seconds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">set_page_load_timeout</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">page_source</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the source of the current page.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The source of the current page</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">page_source</span>

<div class="viewcode-block" id="Spydr.paste_from_clipboard"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.paste_from_clipboard">[docs]</a>    <span class="k">def</span> <span class="nf">paste_from_clipboard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Paste clipboard (send_keys) to the given element. (Chrome only)</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">paste_from_clipboard</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.parent_element"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.parent_element">[docs]</a>    <span class="k">def</span> <span class="nf">parent_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the parent element of the given element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Returns:</span>
<span class="sd">            WebElement: The parent element of the given element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">parent_element</span></div>

<div class="viewcode-block" id="Spydr.previous_element"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.previous_element">[docs]</a>    <span class="k">def</span> <span class="nf">previous_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the previous element of the given element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Returns:</span>
<span class="sd">            WebElement: The previous element of the given element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">previous_element</span></div>

<div class="viewcode-block" id="Spydr.quit"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.quit">[docs]</a>    <span class="k">def</span> <span class="nf">quit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Quit the Spydr webdriver.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.radio_to_be"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.radio_to_be">[docs]</a>    <span class="k">def</span> <span class="nf">radio_to_be</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">is_checked</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the radio button, identified by the locator, to the given state (is_checked).</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the radio button or WebElement</span>
<span class="sd">            is_checked (bool): whether the radio button is to be checked</span>

<span class="sd">        Raises:</span>
<span class="sd">            InvalidSelectorException: Raise an error when the element is not a radio button</span>
<span class="sd">            WebDriverException: Raise an error when failing to set the given state</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">radio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">radio</span><span class="o">.</span><span class="n">tag_name</span> <span class="o">!=</span> <span class="s1">&#39;input&#39;</span> <span class="ow">and</span> <span class="n">radio</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;radio&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSelectorException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Element is not a radio button: </span><span class="si">{</span><span class="n">locator</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_checked</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">radio</span><span class="o">.</span><span class="n">is_selected</span><span class="p">()</span> <span class="ow">and</span> <span class="n">radio</span><span class="o">.</span><span class="n">is_enabled</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_checkbox_or_radio_clicked</span><span class="p">(</span><span class="n">radio</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">WebDriverException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Failed to click on the element: </span><span class="si">{</span><span class="n">locator</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">radio</span><span class="o">.</span><span class="n">is_selected</span><span class="p">()</span> <span class="ow">and</span> <span class="n">radio</span><span class="o">.</span><span class="n">is_enabled</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;arguments[0].checked = false;&#39;</span><span class="p">,</span> <span class="n">radio</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.randomized_string"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.randomized_string">[docs]</a>    <span class="k">def</span> <span class="nf">randomized_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">punctuation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">whitespace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_upper</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate a randomized string in the given size using the given characters.</span>

<span class="sd">        Args:</span>
<span class="sd">            size (int, optional): Size of the string. Defaults to 10.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            sequence (str): Sequence. Defaults to string.ascii_letters.</span>
<span class="sd">            digits (bool): Add `string.digits` to sequence.</span>
<span class="sd">            punctuation (bool): Add `string.punctuation` to sequence.</span>
<span class="sd">            whitespace (bool): Add whitespace to sequence.</span>
<span class="sd">            is_upper (bool): Uppercase the randomized string. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            [type]: [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">sequence</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span>
        <span class="k">if</span> <span class="n">digits</span><span class="p">:</span>
            <span class="n">sequence</span> <span class="o">+=</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span>
        <span class="k">if</span> <span class="n">punctuation</span><span class="p">:</span>
            <span class="n">sequence</span> <span class="o">+=</span> <span class="n">string</span><span class="o">.</span><span class="n">punctuation</span>
        <span class="k">if</span> <span class="n">whitespace</span><span class="p">:</span>
            <span class="n">sequence</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span>

        <span class="n">string_</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">string_</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">if</span> <span class="n">is_upper</span> <span class="k">else</span> <span class="n">string_</span></div>

<div class="viewcode-block" id="Spydr.rect"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.rect">[docs]</a>    <span class="k">def</span> <span class="nf">rect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the size and location of the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The size and location of the element as dict: {&#39;x&#39;: 0, &#39;y&#39;: 0, &#39;width&#39;: 100, &#39;height&#39;: 100}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">rect</span></div>

<div class="viewcode-block" id="Spydr.refresh"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Refresh the current page.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.refresh_until_page_changed"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.refresh_until_page_changed">[docs]</a>    <span class="k">def</span> <span class="nf">refresh_until_page_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">body_text_diff</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Refresh the page (every `frequency`) until the page changes or until `timeout`.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            frequency (int): Refresh frequency</span>
<span class="sd">            timeout (int): Time allowed to refresh. Defaults to 10.</span>
<span class="sd">            body_text_diff (bool): Compare `body` text when True.  Compare `page_source` when False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the page is changed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">poll_frequency</span><span class="o">=</span><span class="n">frequency</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_page_changed_after_refresh</span><span class="p">(</span><span class="n">body_text_diff</span><span class="p">))</span></div>

<div class="viewcode-block" id="Spydr.remove_attribute"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.remove_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">remove_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">attribute</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove the given attribute from the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            attribute (str): Attribute name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">remove_attribute</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.remove_class"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.remove_class">[docs]</a>    <span class="k">def</span> <span class="nf">remove_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">class_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove the given CSS class to the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            class_name (str): CSS class name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">remove_class</span><span class="p">(</span><span class="n">class_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.remove_file"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.remove_file">[docs]</a>    <span class="k">def</span> <span class="nf">remove_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove the file.</span>

<span class="sd">        Args:</span>
<span class="sd">            file (str): File path</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">mkdir</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.right_click"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.right_click">[docs]</a>    <span class="k">def</span> <span class="nf">right_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Right-click on the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">right_click</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.right_click_with_offset"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.right_click_with_offset">[docs]</a>    <span class="k">def</span> <span class="nf">right_click_with_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Right-click on the element with x and y offsets.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            x_offset (int): X offset from the left of the element. Defaults to 1.</span>
<span class="sd">            y_offset (int): Y offset from the top of the element. Defaults to 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">right_click_with_offset</span><span class="p">(</span><span class="n">x_offset</span><span class="o">=</span><span class="n">x_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">=</span><span class="n">y_offset</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.save_cookies"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.save_cookies">[docs]</a>    <span class="k">def</span> <span class="nf">save_cookies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save cookies as a JSON file.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): File name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.json&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">cookie_file</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_cookies</span><span class="p">(),</span> <span class="n">cookie_file</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.save_ini"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.save_ini">[docs]</a>    <span class="k">def</span> <span class="nf">save_ini</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save INI file.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ini</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ini</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.save_screenshot"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.save_screenshot">[docs]</a>    <span class="k">def</span> <span class="nf">save_screenshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save a screenshot of the current window to filename (PNG).</span>

<span class="sd">        Default directory for saved screenshots is defined in: screen_root.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): Filename of the screenshot</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the file is saved</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wait_until_page_loaded</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">save_screenshot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">screen_root</span><span class="p">))</span></div>

<div class="viewcode-block" id="Spydr.screenshot"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.screenshot">[docs]</a>    <span class="k">def</span> <span class="nf">screenshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save a screenshot of the element to the filename (PNG).</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            filename ([type]): Filename of the screenshot</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the file is saved</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">save_screenshot</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.screenshot_as_base64"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.screenshot_as_base64">[docs]</a>    <span class="k">def</span> <span class="nf">screenshot_as_base64</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the screenshot of the element as a Base64 encoded string</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Base64 encoded string of the screenshot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">screenshot_as_base64</span></div>

<div class="viewcode-block" id="Spydr.screenshot_as_png"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.screenshot_as_png">[docs]</a>    <span class="k">def</span> <span class="nf">screenshot_as_png</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the screenshot of the element as a binary data.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Returns:</span>
<span class="sd">            bytes: Binary data of the screenshot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">screenshot_as_png</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">script_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Timeout for script.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: Script timeout</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__script_timeout</span>

    <span class="nd">@script_timeout</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">script_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seconds</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__script_timeout</span> <span class="o">=</span> <span class="n">seconds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">set_script_timeout</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>

<div class="viewcode-block" id="Spydr.scroll_into_view"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.scroll_into_view">[docs]</a>    <span class="k">def</span> <span class="nf">scroll_into_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">behavior</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">block</span><span class="o">=</span><span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Scroll the element&#39;s parent to be displayed.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            behavior (str): Defines the transition animation. One of `auto` or `smooth`. Defaults to &#39;auto&#39;.</span>
<span class="sd">            block (str): Defines vertical alignment. One of `start`, `center`, `end`, or `nearest`. Defaults to &#39;start&#39;.</span>
<span class="sd">            inline (str): Defines horizontal alignment. One of `start`, `center`, `end`, or `nearest`. Defaults to &#39;nearest&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">scroll_into_view</span><span class="p">(</span><span class="n">behavior</span><span class="o">=</span><span class="n">behavior</span><span class="p">,</span> <span class="n">block</span><span class="o">=</span><span class="n">block</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="n">inline</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.scroll_to"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.scroll_to">[docs]</a>    <span class="k">def</span> <span class="nf">scroll_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Scroll the elment to the given x- and y-coordinates. (IE not supported)</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            x (int): x-coordinate</span>
<span class="sd">            y (int): y-coordinate</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">scroll_to</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.select_options"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.select_options">[docs]</a>    <span class="k">def</span> <span class="nf">select_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select_locator</span><span class="p">,</span> <span class="n">filter_by</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">filter_value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get options of an select element.  Filter the options by attribute if `filter_value` is given.</span>

<span class="sd">        Args:</span>
<span class="sd">            select_locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            filter_by (str): Filter options by attribute. Defaults to &#39;value&#39;.</span>
<span class="sd">            filter_value (str): Filter option&#39;s attribute by value. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[WebElement]: All filtered options</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">select_locator</span><span class="p">)</span><span class="o">.</span><span class="n">select_options</span><span class="p">(</span><span class="n">filter_by</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">filter_value</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.select_to_be"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.select_to_be">[docs]</a>    <span class="k">def</span> <span class="nf">select_to_be</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select_locator</span><span class="p">,</span> <span class="n">option_value</span><span class="p">,</span> <span class="n">selected</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">option_by</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set `selected` state of the given `option` in the `select` drop-down menu.</span>

<span class="sd">        Args:</span>
<span class="sd">            select_locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            option_value (int/str): The value to identify the option by using `option_by` method.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            selected (bool): Option `selected` state to be</span>
<span class="sd">            option_by (str): The method to identify the option. One of `value`, `text`, or `index`. Defaults to &#39;value&#39;.</span>

<span class="sd">        Raises:</span>
<span class="sd">            InvalidSelectorException: Raise an error when the element is not a select</span>

<span class="sd">        Examples:</span>
<span class="sd">            | # Deselect option: &lt;option value=&quot;3&quot;&gt;Three&lt;/option&gt;</span>
<span class="sd">            | select_to_be(&#39;#group&#39;, 3, selected=False)</span>
<span class="sd">            | # Select option: &lt;option value=&quot;5&quot;&gt;Volvo&lt;/option&gt;</span>
<span class="sd">            | select_to_be(&#39;#car&#39;, &#39;Volvo&#39;, option_by=&#39;text&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">select</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_selectable</span><span class="p">(</span><span class="n">select_locator</span><span class="p">))</span>
        <span class="n">option</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">select</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">WebDriverException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Select has no option: </span><span class="si">{</span><span class="n">select_locator</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">option_by</span> <span class="o">==</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span>
            <span class="n">option</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[value=&quot;</span><span class="si">{</span><span class="n">option_value</span><span class="si">}</span><span class="s1">&quot;]&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">option_by</span> <span class="o">==</span> <span class="s1">&#39;text&#39;</span><span class="p">:</span>
            <span class="n">option</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;//*[text()=&quot;</span><span class="si">{</span><span class="n">option_value</span><span class="si">}</span><span class="s1">&quot;]&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">option_by</span> <span class="o">==</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="s1">&#39;tag_name=option&#39;</span><span class="p">)</span>
            <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">option_value</span><span class="p">)</span>
            <span class="n">option</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">options</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">option</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">WebDriverException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot using &quot;</span><span class="si">{</span><span class="n">option_by</span><span class="si">}</span><span class="s1">&quot; to identify the option: </span><span class="si">{</span><span class="n">option_value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">option</span><span class="o">.</span><span class="n">is_selected</span><span class="p">()</span> <span class="o">!=</span> <span class="n">selected</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">click</span><span class="p">(</span><span class="n">option</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.select_to_be_random"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.select_to_be_random">[docs]</a>    <span class="k">def</span> <span class="nf">select_to_be_random</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select_locator</span><span class="p">,</span> <span class="n">ignored_options</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Randomly select an `option` in the `select` menu</span>

<span class="sd">        Args:</span>
<span class="sd">            select_locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            ignored_options (list): Options to exlcude from selection. Defaults to [None, &quot;&quot;, &quot;0&quot;].</span>

<span class="sd">        Raises:</span>
<span class="sd">            WebDriverException: Raise an error if failing to randomly select an option</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">select</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_selectable</span><span class="p">(</span><span class="n">select_locator</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">select</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">WebDriverException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Select has no option: </span><span class="si">{</span><span class="n">select_locator</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">options</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="s1">&#39;css=option&#39;</span><span class="p">)</span>

        <span class="n">random_option</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_option</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">ignored_options</span><span class="o">=</span><span class="n">ignored_options</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">random_option</span><span class="p">:</span>
            <span class="n">random_option</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">WebDriverException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot randomly select an option in: </span><span class="si">{</span><span class="n">select_locator</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.select_to_be_all"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.select_to_be_all">[docs]</a>    <span class="k">def</span> <span class="nf">select_to_be_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select_locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Select all `option` in a **multiple** `select` drop-down menu.</span>

<span class="sd">        Args:</span>
<span class="sd">            select_locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">select</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">select_locator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_multiple_select_to_be</span><span class="p">(</span><span class="n">select</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.select_to_be_none"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.select_to_be_none">[docs]</a>    <span class="k">def</span> <span class="nf">select_to_be_none</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select_locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;De-select all `option` in a **multiple** `select` drop-down menu.</span>

<span class="sd">        Args:</span>
<span class="sd">            select_locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">select</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">select_locator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_multiple_select_to_be</span><span class="p">(</span><span class="n">select</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.selected_options"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.selected_options">[docs]</a>    <span class="k">def</span> <span class="nf">selected_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">select_locator</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get values of **selected** `option` in a `select` drop-down menu.</span>

<span class="sd">        Args:</span>
<span class="sd">            select_locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            by (str): Get selected options by `value`, `text`, or `index`. Defaults to &#39;value&#39;.</span>

<span class="sd">        Raises:</span>
<span class="sd">            InvalidSelectorException: Raise an error when element is not a select element</span>
<span class="sd">            WebDriverException: Raise an error when the given `by` is unsupported</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[int/str]: list of values of all selected options</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">select</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">select_locator</span><span class="p">)</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">select</span><span class="o">.</span><span class="n">tag_name</span> <span class="o">!=</span> <span class="s1">&#39;select&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSelectorException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Element is not a select: </span><span class="si">{</span><span class="n">select_locator</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span> <span class="o">==</span> <span class="s1">&#39;ie&#39;</span><span class="p">:</span>
            <span class="n">multiple</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;multiple&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">select</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="s1">&#39;tag_name=option&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">option</span><span class="o">.</span><span class="n">is_selected</span><span class="p">():</span>
                    <span class="n">options</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">multiple</span><span class="p">:</span>
                        <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">options</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">select</span><span class="o">.</span><span class="n">selected_options</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">by</span> <span class="o">==</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">opt</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">options</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">by</span> <span class="o">==</span> <span class="s1">&#39;text&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">opt</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">options</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">by</span> <span class="o">==</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">opt</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">options</span><span class="p">]</span>

        <span class="k">raise</span> <span class="n">WebDriverException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unsupported selected options by: </span><span class="si">{</span><span class="n">by</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.send_keys"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.send_keys">[docs]</a>    <span class="k">def</span> <span class="nf">send_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="o">*</span><span class="n">keys</span><span class="p">,</span> <span class="n">blur</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wait_until_enabled</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Simulate typing into the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            *keys: Any combinations of strings</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            blur (bool): Lose focus after sending keys. Defaults to False.</span>
<span class="sd">            wait_until_enabled (bool): Whether to wait until the element `is_enabled()` before sending keys. Defaults to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="o">*</span><span class="n">keys</span><span class="p">,</span> <span class="n">blur</span><span class="o">=</span><span class="n">blur</span><span class="p">,</span> <span class="n">wait_until_enabled</span><span class="o">=</span><span class="n">wait_until_enabled</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.set_attribute"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.set_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">set_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the given value to the attribute of the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            attribute (str): Attribute name</span>
<span class="sd">            value (str): Attribute name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.set_ini_key"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.set_ini_key">[docs]</a>    <span class="k">def</span> <span class="nf">set_ini_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the value of the given key in INI.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): Key name</span>
<span class="sd">            value: Value (any data type JSON supports)</span>
<span class="sd">            section: INI section. Defaults to the default section.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ini</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ini</span><span class="o">.</span><span class="n">set_key</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">section</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.set_window_position"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.set_window_position">[docs]</a>    <span class="k">def</span> <span class="nf">set_window_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">window_handle</span><span class="o">=</span><span class="s1">&#39;current&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the x and y position of the current window</span>

<span class="sd">        Args:</span>
<span class="sd">            x (int): x-coordinate in pixels</span>
<span class="sd">            y (int): y-coordinate in pixels</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            window_handle (str): Window handle. Defaults to &#39;current&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Window rect as dict: {&#39;x&#39;: 0, &#39;y&#39;: 0, &#39;width&#39;: 100, &#39;height&#39;: 100}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">set_window_position</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">window_handle</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.set_window_rect"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.set_window_rect">[docs]</a>    <span class="k">def</span> <span class="nf">set_window_rect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the x, y, width, and height of the current window.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            x (int): x-coordinate in pixels. Defaults to None.</span>
<span class="sd">            y (int): y-coordinate in pixels. Defaults to None.</span>
<span class="sd">            width (int): Window width in pixels. Defaults to None.</span>
<span class="sd">            height (int): Window height in pixels. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Window rect as dict: {&#39;x&#39;: 0, &#39;y&#39;: 0, &#39;width&#39;: 100, &#39;height&#39;: 100}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">set_window_rect</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.set_window_size"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.set_window_size">[docs]</a>    <span class="k">def</span> <span class="nf">set_window_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">window_handle</span><span class="o">=</span><span class="s1">&#39;current&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the width and height of the current window.</span>

<span class="sd">        Args:</span>
<span class="sd">            width (int, optional): Window width in pixels. Defaults to None.</span>
<span class="sd">            height (int, optional): Window height in pixels. Defaults to None.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            window_handle (str): Window handle. Defaults to &#39;current&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Window rect as dict: {&#39;x&#39;: 0, &#39;y&#39;: 0, &#39;width&#39;: 100, &#39;height&#39;: 100}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">set_window_size</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">window_handle</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.shift_click_from_and_to"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.shift_click_from_and_to">[docs]</a>    <span class="k">def</span> <span class="nf">shift_click_from_and_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_locator</span><span class="p">,</span> <span class="n">to_locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shift click from `from_locator` to `to_locator`.</span>

<span class="sd">        Args:</span>
<span class="sd">            from_locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            to_locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">from_element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">from_locator</span><span class="p">)</span>
        <span class="n">to_element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">to_locator</span><span class="p">)</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">SHIFT</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">()</span><span class="o">.</span><span class="n">key_down</span><span class="p">(</span><span class="n">shift</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">(</span><span class="n">from_element</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">(</span><span class="n">to_element</span><span class="p">)</span><span class="o">.</span><span class="n">key_up</span><span class="p">(</span><span class="n">shift</span><span class="p">)</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.show"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.size"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.size">[docs]</a>    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The size of the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The size of the element as dict: {&#39;width&#39;: 100, &#39;height&#39;: 100}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">size</span></div>

<div class="viewcode-block" id="Spydr.sleep"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.sleep">[docs]</a>    <span class="k">def</span> <span class="nf">sleep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seconds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sleep the given seconds.</span>

<span class="sd">        Args:</span>
<span class="sd">            seconds (int): Seconds to sleep</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="p">,</span> <span class="n">seconds</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span></div>

<div class="viewcode-block" id="Spydr.submit"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.submit">[docs]</a>    <span class="k">def</span> <span class="nf">submit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Submit a form.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">submit</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.switch_to_active_element"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.switch_to_active_element">[docs]</a>    <span class="k">def</span> <span class="nf">switch_to_active_element</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Switch to active element.</span>

<span class="sd">        Returns:</span>
<span class="sd">            WebElement: Active Element</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">active_element</span></div>

<div class="viewcode-block" id="Spydr.switch_to_alert"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.switch_to_alert">[docs]</a>    <span class="k">def</span> <span class="nf">switch_to_alert</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Switch to alert.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Alert: Alert</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">alert</span></div>

<div class="viewcode-block" id="Spydr.switch_to_default_content"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.switch_to_default_content">[docs]</a>    <span class="k">def</span> <span class="nf">switch_to_default_content</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Switch to default content.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">default_content</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.switch_to_frame"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.switch_to_frame">[docs]</a>    <span class="k">def</span> <span class="nf">switch_to_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Switch to frame.</span>

<span class="sd">        Args:</span>
<span class="sd">            frame_locator (str/WebElement): The locator to identify the frame or WebElement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">frame_locator</span><span class="p">))</span></div>

<div class="viewcode-block" id="Spydr.switch_to_frame_and_wait_until_elment_located_in_frame"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.switch_to_frame_and_wait_until_elment_located_in_frame">[docs]</a>    <span class="k">def</span> <span class="nf">switch_to_frame_and_wait_until_elment_located_in_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_locator</span><span class="p">,</span> <span class="n">element_locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Switch to the given frame and wait until the element is located within the frame.</span>

<span class="sd">        Args:</span>
<span class="sd">            frame_locator (str/WebElement): The locator to identify the frame or WebElement</span>
<span class="sd">            element_locator (str): The locator to identify the element</span>

<span class="sd">        Returns:</span>
<span class="sd">            False/WebElement: Return False if not located. Return WebElement if located.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wait_until_frame_available_and_switch</span><span class="p">(</span><span class="n">frame_locator</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_located</span><span class="p">(</span><span class="n">element_locator</span><span class="p">))</span></div>

<div class="viewcode-block" id="Spydr.switch_to_last_window_handle"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.switch_to_last_window_handle">[docs]</a>    <span class="k">def</span> <span class="nf">switch_to_last_window_handle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Switch to the last opened tab or window.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">switch_to_window</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_handles</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span></div>

<div class="viewcode-block" id="Spydr.switch_to_parent_frame"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.switch_to_parent_frame">[docs]</a>    <span class="k">def</span> <span class="nf">switch_to_parent_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Switch to parent frame.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">parent_frame</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spydr.switch_to_window"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.switch_to_window">[docs]</a>    <span class="k">def</span> <span class="nf">switch_to_window</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Switch to window.</span>

<span class="sd">        Args:</span>
<span class="sd">            window_name (str): Window name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">window</span><span class="p">(</span><span class="n">window_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.t"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.t">[docs]</a>    <span class="k">def</span> <span class="nf">t</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get value from YML instance by using &quot;dot notation&quot; key.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): Dot notation key</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            **kwargs: Format key value (str) with `str.format(**kwargs)`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            value of dot notation key</span>

<span class="sd">        Examples:</span>
<span class="sd">            | # YAML</span>
<span class="sd">            | today:</span>
<span class="sd">            |   dashboard:</span>
<span class="sd">            |     search: &#39;#search&#39;</span>
<span class="sd">            |     name: &#39;Name is {name}&#39;</span>
<span class="sd">            |</span>
<span class="sd">            | t(&#39;today.dashboard.search&#39;) # &#39;#search&#39;</span>
<span class="sd">            | t(&#39;today.dashboard.name&#39;, name=&#39;Spydr&#39;) # &#39;Name is Spydr&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">yml</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.tag_name"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.tag_name">[docs]</a>    <span class="k">def</span> <span class="nf">tag_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the element&#39;s tagName.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: tagName</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">tag_name</span></div>

<div class="viewcode-block" id="Spydr.text"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.text">[docs]</a>    <span class="k">def</span> <span class="nf">text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">typecast</span><span class="o">=</span><span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The the element&#39;s text. (Only works when the element is in the viewport)</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            typecast: Typecast the text. Defaults to `str`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The text, by `typecast`, of the element</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">typecast</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.text_content"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.text_content">[docs]</a>    <span class="k">def</span> <span class="nf">text_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the element&#39;s text. (Works whether the element is in the viewport or not)</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The text of the element</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">text_content</span></div>

<div class="viewcode-block" id="Spydr.texts"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.texts">[docs]</a>    <span class="k">def</span> <span class="nf">texts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">typecast</span><span class="o">=</span><span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;All Elements&#39; text.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str): The locator to identify the elements or list[WebElement]</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            typecast: Typecast the texts. Defaults to `str`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: list of texts, by `typecast`, of the given elements</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">typecast</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">locator</span><span class="p">)]</span></div>

<div class="viewcode-block" id="Spydr.text_to_file"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.text_to_file">[docs]</a>    <span class="k">def</span> <span class="nf">text_to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">suffix</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Write text to the given filename</span>

<span class="sd">        Args:</span>
<span class="sd">            text (str): Text to write</span>
<span class="sd">            filename (str): filename of the text file</span>
<span class="sd">            suffix (str): suffix of the text file</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Absolute path of the file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">text_file</span><span class="p">:</span>
            <span class="n">text_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">file_</span></div>

<div class="viewcode-block" id="Spydr.timedelta"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.timedelta">[docs]</a>    <span class="k">def</span> <span class="nf">timedelta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the date by the given delta from today.</span>

<span class="sd">        Args:</span>
<span class="sd">            days (int): Delta days from today</span>
<span class="sd">            format (str, optional): Date format. Defaults to &#39;%m/%d/%Y&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Delta date from today</span>

<span class="sd">        Examples:</span>
<span class="sd">            | today() # 2020/12/10</span>
<span class="sd">            | timedelta(1) # 2020/12/11</span>
<span class="sd">            | timedelta(-1) # 2020/12/09</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">days</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">delta</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="nb">format</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Spydr webdriver timeout for implicitly_wait, page_load_timeout, and script_timeout</span>

<span class="sd">        Returns:</span>
<span class="sd">            [int]: Spydr webdriver timeout</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span>

    <span class="nd">@timeout</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seconds</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span> <span class="o">=</span> <span class="n">seconds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">implicitly_wait</span> <span class="o">=</span> <span class="n">seconds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">page_load_timeout</span> <span class="o">=</span> <span class="n">seconds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">script_timeout</span> <span class="o">=</span> <span class="n">seconds</span>

<div class="viewcode-block" id="Spydr.timestamp"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.timestamp">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">timestamp</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get current local timestamp with optional prefix and/or suffix.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            prefix (str): Prefix for timestamp. Defaults to &#39;&#39;.</span>
<span class="sd">            suffix (str): Suffix for timestamp. Defaults to &#39;&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Timestamp with optional prefix and suffix</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">strftime</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">%H%M%S&#39;</span><span class="p">,</span> <span class="n">localtime</span><span class="p">())</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">timestamp</span><span class="si">}{</span><span class="n">suffix</span><span class="si">}</span><span class="s1">&#39;</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the title of the current page.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Title of the current page</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">title</span>

<div class="viewcode-block" id="Spydr.today"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.today">[docs]</a>    <span class="k">def</span> <span class="nf">today</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Today&#39;s date.</span>

<span class="sd">        Args:</span>
<span class="sd">            format (str, optional): Date format. Defaults to &#39;%m/%d/%Y&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Today&#39;s date in the given format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="nb">format</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.toggle_attribute"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.toggle_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">toggle_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Toggle a Boolean attribute of the given element. (IE not supported)</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            name ([type]): Attribute name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">toggle_attribute</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.toggle_class"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.toggle_class">[docs]</a>    <span class="k">def</span> <span class="nf">toggle_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">class_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Toggole the given CSS class of the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            class_name (str): CSS class name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">toggle_class</span><span class="p">(</span><span class="n">class_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.trigger"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.trigger">[docs]</a>    <span class="k">def</span> <span class="nf">trigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Trigger the given event on the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            event (str): Event name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">trigger</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.value"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.value">[docs]</a>    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">typecast</span><span class="o">=</span><span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the value of the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            typecast: Typecast the value. Defaults to `str`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The value, by `typecast`, of the element</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">typecast</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.values"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.values">[docs]</a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">typecast</span><span class="o">=</span><span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the values of the elements.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str): The locator to identify the elements or list[WebElement]</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            typecast: Typecast the values. Defaults to `str`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: list of values, by `typecast`, of the given elements</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">typecast</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">locator</span><span class="p">)]</span></div>

<div class="viewcode-block" id="Spydr.wait_until"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">poll_frequency</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ignored_exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">NoSuchElementException</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Create a WebDriverWait instance and wait until the given method is evaluated to not False.</span>

<span class="sd">        Args:</span>
<span class="sd">            method (callable): Method to call</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            timeout (int): Timeout. Defaults to `self.timeout`.</span>
<span class="sd">            poll_frequency (float): Sleep interval between method calls. Defaults to 0.5.</span>
<span class="sd">            ignored_exceptions (list[Exception]): Exception classes to ignore during calls. Defaults to (NoSuchElementException).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Any applicable return from the method call</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">timeout</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span> <span class="k">if</span> <span class="n">timeout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">poll_frequency</span><span class="p">,</span> <span class="n">ignored_exceptions</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">method</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.wait_until_alert_present"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_alert_present">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_alert_present</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until alert is present.</span>

<span class="sd">        Returns:</span>
<span class="sd">            False/Alert: Return False if not present. Return Alert if present.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">expected_conditions</span><span class="o">.</span><span class="n">alert_is_present</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.wait_until_attribute_contains"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_attribute_contains">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_attribute_contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until the element&#39;s attribute contains the given value.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            attribute (str): Attribute name</span>
<span class="sd">            value (str): value to check</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether value is found in the element&#39;s attribute</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_value_in_element_attribute</span><span class="p">(</span><span class="n">locator</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span></div>

<div class="viewcode-block" id="Spydr.wait_until_class_contains"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_class_contains">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_class_contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">class_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until the element contains the given CSS class.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            class_name (str): CSS class name</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element contains the given CSS class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_class</span><span class="p">(</span><span class="n">locator</span><span class="p">,</span> <span class="n">class_name</span><span class="p">))</span></div>

<div class="viewcode-block" id="Spydr.wait_until_class_excludes"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_class_excludes">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_class_excludes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">class_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until the element excludes the given CSS class.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            class_name (str): CSS class name</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element excludes the given CSS class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_class</span><span class="p">(</span><span class="n">locator</span><span class="p">,</span> <span class="n">class_name</span><span class="p">))</span></div>

<div class="viewcode-block" id="Spydr.wait_until_displayed"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_displayed">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_displayed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until the element is displayed.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element is displayed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_displayed</span><span class="p">(</span><span class="n">locator</span><span class="p">))</span></div>

<div class="viewcode-block" id="Spydr.wait_until_displayed_and_get_elmement"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_displayed_and_get_elmement">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_displayed_and_get_elmement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until the element is displayed and return the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Returns:</span>
<span class="sd">            WebElement: WebElement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wait_until_displayed</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.wait_until_enabled"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_enabled">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until the element is enabled.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element is enabled</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_enabled</span><span class="p">(</span><span class="n">locator</span><span class="p">))</span></div>

<div class="viewcode-block" id="Spydr.wait_until_frame_available_and_switch"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_frame_available_and_switch">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_frame_available_and_switch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until the given frame is available and switch to it.</span>

<span class="sd">        Args:</span>
<span class="sd">            frame_locator (str/WebElement): The locator to identify the frame or WebElement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_frame_switched</span><span class="p">(</span><span class="n">frame_locator</span><span class="p">))</span></div>

<div class="viewcode-block" id="Spydr.wait_until_ignored_timeout"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_ignored_timeout">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_ignored_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until the given method timed-out and ignore `TimeoutException`.</span>

<span class="sd">        Args:</span>
<span class="sd">            method ([type]): Method to call</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            timeout (int): [description]. Defaults to 3.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Any applicable return from the method call</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_timeout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">_timeout</span></div>

<div class="viewcode-block" id="Spydr.wait_until_loading_finished"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_loading_finished">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_loading_finished</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until `loading-liking` element shows up and then disappears.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            seconds (int): Seconds to give up waiting. Defaults to 2.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element is not displayed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">how</span><span class="p">,</span> <span class="n">what</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_locator</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>
        <span class="n">implicitly_wait</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">implicitly_wait</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">implicitly_wait</span> <span class="o">=</span> <span class="n">seconds</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="p">,</span> <span class="n">seconds</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">wd</span><span class="p">:</span> <span class="n">wd</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">how</span><span class="p">,</span> <span class="n">what</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="p">,</span> <span class="n">seconds</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">wd</span><span class="p">:</span> <span class="ow">not</span> <span class="n">wd</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">how</span><span class="p">,</span> <span class="n">what</span><span class="p">))</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">NoSuchElementException</span><span class="p">,</span> <span class="n">StaleElementReferenceException</span><span class="p">,</span> <span class="n">TimeoutException</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">implicitly_wait</span> <span class="o">=</span> <span class="n">implicitly_wait</span></div>

<div class="viewcode-block" id="Spydr.wait_until_not"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_not">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_not</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a WebDriverWait instance and wait until the given method is evaluated to False.</span>

<span class="sd">        Args:</span>
<span class="sd">            method (callable): Method to call</span>

<span class="sd">        Returns:</span>
<span class="sd">            Any applicable return from the method call</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until_not</span><span class="p">(</span><span class="n">method</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.wait_until_not_displayed"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_not_displayed">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_not_displayed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until the element is not displayed in the given seconds.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str): The locator to identify the element</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            seconds (int): Seconds to give up waiting. Defaults to 2.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element is not displayed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">how</span><span class="p">,</span> <span class="n">what</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_locator</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>
        <span class="n">implicitly_wait</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">implicitly_wait</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">implicitly_wait</span> <span class="o">=</span> <span class="n">seconds</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="p">,</span> <span class="n">seconds</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">wd</span><span class="p">:</span> <span class="ow">not</span> <span class="n">wd</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">how</span><span class="p">,</span> <span class="n">what</span><span class="p">))</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">NoSuchElementException</span><span class="p">,</span> <span class="n">StaleElementReferenceException</span><span class="p">,</span> <span class="n">TimeoutException</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">implicitly_wait</span> <span class="o">=</span> <span class="n">implicitly_wait</span></div>

<div class="viewcode-block" id="Spydr.wait_until_number_of_windows_to_be"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_number_of_windows_to_be">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_number_of_windows_to_be</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until number of windows matches the given number.</span>

<span class="sd">        Args:</span>
<span class="sd">            number (int): Number of windows</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether number of windows matching the given number</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="n">expected_conditions</span><span class="o">.</span><span class="n">number_of_windows_to_be</span><span class="p">(</span><span class="n">number</span><span class="p">))</span></div>

<div class="viewcode-block" id="Spydr.wait_until_page_loaded"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_page_loaded">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_page_loaded</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until `document.readyState` is `complete`.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_page_loaded</span><span class="p">())</span></div>

<div class="viewcode-block" id="Spydr.wait_until_selected"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_selected">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_selected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until the element is selected.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element is selected</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_selected</span><span class="p">(</span><span class="n">locator</span><span class="p">))</span></div>

<div class="viewcode-block" id="Spydr.wait_until_selection_to_be"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_selection_to_be">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_selection_to_be</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">is_selected</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until the element&#39;s `selected` state to match the given state.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            is_selected (bool): Element&#39;s `selected` state</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element&#39;s `selected` state matching the given state</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_selected</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span> <span class="o">==</span> <span class="n">is_selected</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spydr.wait_until_text_contains"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_text_contains">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_text_contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until the element&#39;s text contains the given text.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            text (str): Text to match</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element&#39;s text containing the given text</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">try_fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_and_catch</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_text</span><span class="p">(</span><span class="n">locator</span><span class="p">,</span> <span class="n">text</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">try_fn</span><span class="p">())</span></div>

<div class="viewcode-block" id="Spydr.wait_until_text_equal_to"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_text_equal_to">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_text_equal_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until the element&#39;s text equal to the given text.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            text (str): Text to not match</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element&#39;s text equal to the given text</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">try_fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_and_catch</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_text_matched</span><span class="p">(</span><span class="n">locator</span><span class="p">,</span> <span class="n">text</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">try_fn</span><span class="p">())</span></div>

<div class="viewcode-block" id="Spydr.wait_until_text_excludes"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_text_excludes">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_text_excludes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until the element&#39;s text to exclude the given text.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            text (str): Text to not match</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element&#39;s text excluding the given text</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">try_fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_and_catch</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_text</span><span class="p">(</span><span class="n">locator</span><span class="p">,</span> <span class="n">text</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">try_fn</span><span class="p">())</span></div>

<div class="viewcode-block" id="Spydr.wait_until_text_not_equal_to"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_text_not_equal_to">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_text_not_equal_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until the element&#39;s text not equal to the given text.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str/WebElement): The locator to identify the element or WebElement</span>
<span class="sd">            text (str): Text to not match</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element&#39;s text not equal to the given text</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">try_fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_try_and_catch</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_text_matched</span><span class="p">(</span><span class="n">locator</span><span class="p">,</span> <span class="n">text</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">try_fn</span><span class="p">())</span></div>

<div class="viewcode-block" id="Spydr.wait_until_title_contains"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_title_contains">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_title_contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until the title of the current page contains the given title.</span>

<span class="sd">        Args:</span>
<span class="sd">            title (str): Title to match</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the title containing the given title</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="n">expected_conditions</span><span class="o">.</span><span class="n">title_contains</span><span class="p">(</span><span class="n">title</span><span class="p">))</span></div>

<div class="viewcode-block" id="Spydr.wait_until_url_contains"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.wait_until_url_contains">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_url_contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until the URL of the current window contains the given URL.</span>

<span class="sd">        Args:</span>
<span class="sd">            url (str): URL to match</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            timeout (int): Timeout. Defaults to `self.page_load_timeout`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the URL containing the given URL</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">page_load_timeout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_load_timeout</span>
        <span class="n">timeout</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span> <span class="k">if</span> <span class="n">timeout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">page_load_timeout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">page_load_timeout</span> <span class="o">=</span> <span class="n">timeout</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait_until</span><span class="p">(</span><span class="n">expected_conditions</span><span class="o">.</span><span class="n">url_contains</span><span class="p">(</span><span class="n">url</span><span class="p">),</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">page_load_timeout</span> <span class="o">=</span> <span class="n">page_load_timeout</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">window_handle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the handle of the current window.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The current window handle</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">current_window_handle</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">window_handles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the handles of all windows within the current session.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[str]: List of all window handles</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">window_handles</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">yml</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;YAML file as YML instance.</span>

<span class="sd">        Returns:</span>
<span class="sd">            YML: YML instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__yml</span>

    <span class="nd">@yml</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">yml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">YML</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__yml</span> <span class="o">=</span> <span class="n">file</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__yml</span> <span class="o">=</span> <span class="n">YML</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

<div class="viewcode-block" id="Spydr.zoom"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.Spydr.zoom">[docs]</a>    <span class="k">def</span> <span class="nf">zoom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the zoom factor of a document defined by the viewport.</span>

<span class="sd">        Args:</span>
<span class="sd">            scale (float/str): Zoom factor: 0.8, 1.5, or &#39;150%&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;document.body.style.zoom = arguments[0];&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_auth_extension_as_base64</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
        <span class="n">bytes_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auth_extension_as_bytes</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">bytes_</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_auth_extension_as_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
        <span class="n">manifest</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;manifest_version&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s1">&#39;Spydr Authentication Extension&#39;</span><span class="p">,</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
            <span class="s2">&quot;permissions&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;&lt;all_urls&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;webRequest&#39;</span><span class="p">,</span> <span class="s1">&#39;webRequestBlocking&#39;</span><span class="p">],</span>
            <span class="s2">&quot;background&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;scripts&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;background.js&#39;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="n">background</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">            var username = &#39;</span><span class="si">%s</span><span class="s1">&#39;;</span>
<span class="s1">            var password = &#39;</span><span class="si">%s</span><span class="s1">&#39;;</span>

<span class="s1">            chrome.webRequest.onAuthRequired.addListener(</span>
<span class="s1">                function handler(details) {</span>
<span class="s1">                    if (username == null) {</span>
<span class="s1">                        return { cancel: true };</span>
<span class="s1">                    }</span>

<span class="s1">                    var authCredentials = { username: username, password: username };</span>
<span class="s1">                    // username = password = null;</span>

<span class="s1">                    return { authCredentials: authCredentials };</span>
<span class="s1">                },</span>
<span class="s1">                { urls: [&#39;&lt;all_urls&gt;&#39;] },</span>
<span class="s1">                [&#39;blocking&#39;]</span>
<span class="s1">            );</span>
<span class="s1">        &#39;&#39;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>

        <span class="n">buffer</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
        <span class="nb">zip</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="nb">zip</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="s1">&#39;manifest.json&#39;</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">manifest</span><span class="p">))</span>
        <span class="nb">zip</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="s1">&#39;background.js&#39;</span><span class="p">,</span> <span class="n">background</span><span class="p">)</span>
        <span class="nb">zip</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">buffer</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_auth_extension_as_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.crx&#39;</span><span class="p">):</span>
        <span class="n">bytes_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auth_extension_as_bytes</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;spydr_auth&#39;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extension_root</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">crx_file</span><span class="p">:</span>
            <span class="n">crx_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">bytes_</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">filename</span>

    <span class="k">def</span> <span class="nf">_chrome_options</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># https://chromium.googlesource.com/chromium/src/+/master/chrome/common/chrome_switches.cc</span>
        <span class="c1"># https://chromium.googlesource.com/chromium/src/+/master/chrome/common/pref_names.cc</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ChromeOptions</span><span class="p">()</span>

        <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;allow-running-insecure-content&#39;</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;ignore-certificate-errors&#39;</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;ignore-ssl-errors=yes&#39;</span><span class="p">)</span>

        <span class="n">options</span><span class="o">.</span><span class="n">add_experimental_option</span><span class="p">(</span><span class="s2">&quot;excludeSwitches&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;enable-automation&#39;</span><span class="p">,</span> <span class="s1">&#39;enable-logging&#39;</span><span class="p">])</span>
        <span class="n">options</span><span class="o">.</span><span class="n">add_experimental_option</span><span class="p">(</span><span class="s1">&#39;useAutomationExtension&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">add_experimental_option</span><span class="p">(</span><span class="s2">&quot;prefs&quot;</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">&quot;credentials_enable_service&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;intl&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;accept_languages&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">locale</span>
            <span class="p">},</span>
            <span class="s2">&quot;profile&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;password_manager_enabled&quot;</span><span class="p">:</span> <span class="kc">False</span>
            <span class="p">},</span>
            <span class="s2">&quot;webkit&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;webprefs&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;javascript_can_access_clipboard&quot;</span><span class="p">:</span> <span class="kc">True</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">})</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headless</span><span class="p">:</span>
            <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;headless&#39;</span><span class="p">)</span>
            <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;window-size=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Extension can only be installed when not headless</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auth_username</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">auth_password</span><span class="p">:</span>
                <span class="n">options</span><span class="o">.</span><span class="n">add_encoded_extension</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth_extension_as_base64</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">auth_username</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">auth_password</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">options</span>

    <span class="k">def</span> <span class="nf">_decorator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
        <span class="nd">@wraps</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="c1"># namespace = inspect.currentframe().f_back.f_locals</span>
            <span class="n">namespace</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">f_back</span><span class="o">.</span><span class="n">f_locals</span>
            <span class="k">if</span> <span class="s1">&#39;self&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">namespace</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">namespace</span><span class="p">[</span><span class="s1">&#39;self&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">):</span>
                <span class="n">p1_args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">args</span><span class="p">)</span>
                <span class="n">p2_args</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">=</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
                <span class="n">fn_name</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="vm">__name__</span>
                <span class="n">fn_arguments</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">p1_args</span><span class="p">,</span> <span class="n">p2_args</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fn_name</span><span class="si">}</span><span class="s1">(</span><span class="si">{</span><span class="n">fn_arguments</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wrapper</span>

    <span class="k">def</span> <span class="nf">_firefox_options</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">profile</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">FirefoxProfile</span><span class="p">()</span>
        <span class="n">profile</span><span class="o">.</span><span class="n">accept_untrusted_certs</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">profile</span><span class="o">.</span><span class="n">assume_untrusted_cert_issuer</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># profile.set_preference(&#39;network.automatic-ntlm-auth.trusted-uris&#39;, &#39;.companyname.com&#39;)</span>
        <span class="n">profile</span><span class="o">.</span><span class="n">set_preference</span><span class="p">(</span><span class="s1">&#39;intl.accept_languages&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">locale</span><span class="p">)</span>

        <span class="n">options</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">FirefoxOptions</span><span class="p">()</span>
        <span class="n">options</span><span class="o">.</span><span class="n">profile</span> <span class="o">=</span> <span class="n">profile</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">headless</span><span class="p">:</span>
            <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--headless&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">options</span>

    <span class="k">def</span> <span class="nf">_format_locale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locale</span><span class="p">):</span>
        <span class="n">locale</span> <span class="o">=</span> <span class="n">locale</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;(-[a-zA-Z]</span><span class="si">{2}</span><span class="s1">)$&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span> <span class="o">==</span> <span class="s1">&#39;firefox&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">locale</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">locale</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_logger</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_level</span><span class="p">)</span>

        <span class="n">ch</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
        <span class="n">ch</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_level</span><span class="p">)</span>

        <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_indent</span><span class="si">}</span><span class="s1">%(asctime)s.%(msecs)03d&gt; %(message)s&#39;</span><span class="p">,</span> <span class="n">datefmt</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>

        <span class="n">ch</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">logger</span>

    <span class="k">def</span> <span class="nf">_get_webdriver</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">browsers</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;chrome&#39;</span><span class="p">,</span> <span class="s1">&#39;edge&#39;</span><span class="p">,</span> <span class="s1">&#39;firefox&#39;</span><span class="p">,</span> <span class="s1">&#39;ie&#39;</span><span class="p">,</span> <span class="s1">&#39;safari&#39;</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;log_level&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">}</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">browsers</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">WebDriverException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Browser must be one of </span><span class="si">{</span><span class="n">browsers</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span> <span class="o">==</span> <span class="s1">&#39;chrome&#39;</span><span class="p">:</span>
            <span class="c1"># https://chromedevtools.github.io/devtools-protocol/tot/Browser/#type-PermissionType</span>
            <span class="k">return</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span><span class="n">ChromeDriverManager</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span><span class="o">.</span><span class="n">install</span><span class="p">(),</span>
                                    <span class="n">options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_chrome_options</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span> <span class="o">==</span> <span class="s1">&#39;edge&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Edge</span><span class="p">(</span><span class="n">EdgeChromiumDriverManager</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span><span class="o">.</span><span class="n">install</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span> <span class="o">==</span> <span class="s1">&#39;firefox&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Firefox</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span><span class="n">GeckoDriverManager</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span><span class="o">.</span><span class="n">install</span><span class="p">(),</span>
                                     <span class="n">options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_firefox_options</span><span class="p">(),</span>
                                     <span class="n">service_log_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">devnull</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span> <span class="o">==</span> <span class="s1">&#39;ie&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Ie</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span><span class="n">IEDriverManager</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span><span class="o">.</span><span class="n">install</span><span class="p">(),</span> <span class="n">options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_ie_options</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span> <span class="o">==</span> <span class="s1">&#39;safari&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Safari</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_ie_options</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">IeOptions</span><span class="p">()</span>
        <span class="n">options</span><span class="o">.</span><span class="n">ensure_clean_session</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">options</span><span class="o">.</span><span class="n">full_page_screenshot</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">options</span><span class="o">.</span><span class="n">ignore_protected_mode_settings</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">options</span><span class="o">.</span><span class="n">ignore_zoom_level</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">options</span><span class="o">.</span><span class="n">native_events</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">options</span>

    <span class="k">def</span> <span class="nf">_is_checkbox_or_radio_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">):</span>
        <span class="n">is_selected</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">is_selected</span><span class="p">()</span>
        <span class="n">implicitly_wait</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">implicitly_wait</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">implicitly_wait</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">element</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">element</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">SPACE</span><span class="p">,</span> <span class="n">blur</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">element</span><span class="o">.</span><span class="n">js_click</span><span class="p">()</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">implicitly_wait</span> <span class="o">=</span> <span class="n">implicitly_wait</span>

        <span class="k">return</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">is_selected</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">is_selected</span> <span class="k">else</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_is_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">,</span> <span class="n">scroll_into_view</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">behavior</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">scroll_into_view</span><span class="p">:</span>
                <span class="n">element</span><span class="o">.</span><span class="n">scroll_into_view</span><span class="p">(</span><span class="n">behavior</span><span class="o">=</span><span class="n">behavior</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">element</span><span class="o">.</span><span class="n">is_displayed</span><span class="p">()</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">element</span><span class="o">.</span><span class="n">is_enabled</span><span class="p">():</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="n">element</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">NoSuchWindowException</span><span class="p">,</span> <span class="n">ElementClickInterceptedException</span><span class="p">,</span> <span class="n">ElementNotInteractableException</span><span class="p">,</span> <span class="n">StaleElementReferenceException</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_is_frame_switched</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">switch_to_frame</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="n">NoSuchFrameException</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_is_page_changed_after_refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">body_text_diff</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">before_page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="s1">&#39;//body&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text_content</span> <span class="k">if</span> <span class="n">body_text_diff</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_source</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wait_until_page_loaded</span><span class="p">()</span>
        <span class="n">after_page</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="s1">&#39;//body&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text_content</span> <span class="k">if</span> <span class="n">body_text_diff</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">page_source</span>
        <span class="k">return</span> <span class="n">before_page</span> <span class="o">!=</span> <span class="n">after_page</span>

    <span class="k">def</span> <span class="nf">_is_selectable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="n">select</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">select</span><span class="o">.</span><span class="n">tag_name</span> <span class="o">!=</span> <span class="s1">&#39;select&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">WebDriverException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Locator is not a select element: </span><span class="si">{</span><span class="n">locator</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">select</span><span class="o">.</span><span class="n">is_enabled</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="s1">&#39;css=option&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">select</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">options</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">NoSuchWindowException</span><span class="p">,</span> <span class="n">StaleElementReferenceException</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_multiple_select_to_be</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">WebElement</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">WebDriverException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Not WebElement: </span><span class="si">{</span><span class="n">element</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">tag_name</span> <span class="o">!=</span> <span class="s1">&#39;select&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">WebDriverException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Element is not a select: </span><span class="si">{</span><span class="n">element</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;multiple&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">element</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="s1">&#39;css=option&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">option</span><span class="o">.</span><span class="n">is_selected</span><span class="p">()</span> <span class="o">!=</span> <span class="n">state</span><span class="p">:</span>
                    <span class="n">option</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">WebDriverException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Element is not a multiple select: </span><span class="si">{</span><span class="n">element</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_locator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="n">how</span><span class="p">,</span> <span class="n">what</span> <span class="o">=</span> <span class="n">Utils</span><span class="o">.</span><span class="n">parse_locator</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">how</span> <span class="o">==</span> <span class="s1">&#39;yml&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">yml</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Utils</span><span class="o">.</span><span class="n">parse_locator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="n">what</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">WebDriverException</span><span class="p">(</span>
                    <span class="s1">&#39;Cannot use &quot;yml=&quot; as locator strategy when the instance is not assigned with .yml file.&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">how</span><span class="p">,</span> <span class="n">what</span>

    <span class="k">def</span> <span class="nf">_random_option</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">ignored_options</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">]):</span>
        <span class="n">option</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">option</span><span class="o">.</span><span class="n">value</span> <span class="ow">in</span> <span class="n">ignored_options</span><span class="p">:</span>
            <span class="n">options</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">option</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">options</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_random_option</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">ignored_options</span><span class="o">=</span><span class="n">ignored_options</span><span class="p">)</span>

            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">option</span>

    <span class="k">def</span> <span class="nf">_try_and_catch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">exceptions</span><span class="o">=</span><span class="p">(</span><span class="n">NoSuchElementException</span><span class="p">,</span> <span class="n">StaleElementReferenceException</span><span class="p">),</span> <span class="n">exception_return</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="nd">@wraps</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">exceptions</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">exception_return</span>
        <span class="k">return</span> <span class="n">wrapper</span>

    <span class="k">def</span> <span class="nf">_try_and_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exception_return</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="nd">@wraps</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">timeout_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span>
            <span class="n">seconds_</span> <span class="o">=</span> <span class="n">seconds</span> <span class="k">if</span> <span class="n">seconds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">timeout_</span>
            <span class="k">if</span> <span class="n">timeout_</span> <span class="o">!=</span> <span class="n">seconds_</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">seconds_</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">exception_return</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">timeout_</span> <span class="o">!=</span> <span class="n">seconds_</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout_</span>
        <span class="k">return</span> <span class="n">wrapper</span>

    <span class="k">def</span> <span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn_name</span><span class="p">):</span>
        <span class="n">log_level</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;log_level&#39;</span><span class="p">)</span>
        <span class="n">fn_method</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span> <span class="o">&gt;=</span> <span class="n">log_level</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">fn_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">fn_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;debug&#39;</span><span class="p">,</span> <span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fn_method</span><span class="p">,</span> <span class="s1">&#39;__self__&#39;</span><span class="p">):</span>
            <span class="n">decorator</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_decorator&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">decorator</span><span class="p">(</span><span class="n">fn_method</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fn_method</span></div>


<div class="viewcode-block" id="SpydrElement"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement">[docs]</a><span class="k">class</span> <span class="nc">SpydrElement</span><span class="p">(</span><span class="n">WebElement</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Wrap WebElement with Spydr-specific implementations.</span>

<span class="sd">    Goals:</span>
<span class="sd">        - Add additional functionality to WebElement</span>
<span class="sd">        - Add Spydr locator formats to WebElement</span>

<span class="sd">    Args:</span>
<span class="sd">        spydr_or_element_self (Spydr/SpydrElement): Spydr or SpydrElement self</span>
<span class="sd">        element (WebElement): WebElement instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">spydr_or_element_self</span><span class="p">,</span> <span class="n">element</span><span class="p">):</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="n">instance</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">instance</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spydr_or_element_self</span><span class="p">,</span> <span class="n">element</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spydr_or_element_self</span><span class="p">,</span> <span class="n">Spydr</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spydr</span> <span class="o">=</span> <span class="n">spydr_or_element_self</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spydr_or_element_self</span><span class="p">,</span> <span class="n">WebElement</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spydr</span> <span class="o">=</span> <span class="n">spydr_or_element_self</span><span class="o">.</span><span class="n">spydr</span>

<div class="viewcode-block" id="SpydrElement.add_class"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.add_class">[docs]</a>    <span class="k">def</span> <span class="nf">add_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add the given CSS class to the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            class_name (str): CSS class name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return arguments[0].classList.add(arguments[1]);&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">class_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpydrElement.blur"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.blur">[docs]</a>    <span class="k">def</span> <span class="nf">blur</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Trigger blur event on the element.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;arguments[0].blur();&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="nd">@_WebElementSpydrify</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">children</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the children elements.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[WebElement]: The children elements of the current element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return arguments[0].children;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="SpydrElement.clear"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clears the text if its a text-entry element.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>

<div class="viewcode-block" id="SpydrElement.clear_and_send_keys"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.clear_and_send_keys">[docs]</a>    <span class="k">def</span> <span class="nf">clear_and_send_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">keys</span><span class="p">,</span> <span class="n">blur</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wait_until_enabled</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clear the element and then send the given keys.</span>

<span class="sd">        Args:</span>
<span class="sd">            *keys: Any combinations of strings</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            blur (bool): Lose focus after sending keys. Defaults to False.</span>
<span class="sd">            wait_until_enabled (bool): Whether to wait until the element `is_enabled()` before clearing and sending keys. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            WebElement: WebElement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">wait_until_enabled</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spydr</span><span class="o">.</span><span class="n">wait_until_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="o">*</span><span class="n">keys</span><span class="p">,</span> <span class="n">blur</span><span class="o">=</span><span class="n">blur</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="SpydrElement.click"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.click">[docs]</a>    <span class="k">def</span> <span class="nf">click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scroll_into_view</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Click the element.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            scroll_into_view (bool): Whether to scroll the element into view before clicking. Defaults to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">scroll_into_view</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scroll_into_view</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">click</span><span class="p">()</span></div>

<div class="viewcode-block" id="SpydrElement.closest"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.closest">[docs]</a>    <span class="nd">@_WebElementSpydrify</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">closest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Traverse the current element and its parents until it finds an element that matches the given locator.</span>
<span class="sd">        Will return itself or the matching ancestor. (IE not supported)</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str): The locator to identify the element</span>

<span class="sd">        Returns:</span>
<span class="sd">            WebElement: WebElement</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">how</span><span class="p">,</span> <span class="n">what</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_locator</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">how</span> <span class="o">==</span> <span class="n">HOWS</span><span class="p">[</span><span class="s1">&#39;css&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return arguments[0].closest(`$</span><span class="si">{arguments[1]}</span><span class="s1">`);&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">what</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">how</span> <span class="o">==</span> <span class="n">HOWS</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return arguments[0].closest(`.$</span><span class="si">{arguments[1]}</span><span class="s1">`);&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">what</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">how</span> <span class="o">==</span> <span class="n">HOWS</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return arguments[0].closest(`#$</span><span class="si">{arguments[1]}</span><span class="s1">`);&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">what</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">how</span> <span class="o">==</span> <span class="n">HOWS</span><span class="p">[</span><span class="s1">&#39;link_text&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;xpath=./ancestor-or-self::a[normalize-space(.)=&quot;</span><span class="si">{</span><span class="n">what</span><span class="si">}</span><span class="s1">&quot;]&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">how</span> <span class="o">==</span> <span class="n">HOWS</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return arguments[0].closest(`[name=&quot;$</span><span class="si">{arguments[1]}</span><span class="s1">&quot;]`);&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">what</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">how</span> <span class="o">==</span> <span class="n">HOWS</span><span class="p">[</span><span class="s1">&#39;partial_link_text&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;xpath=./ancestor-or-self::a[contains(normalize-space(.), &quot;</span><span class="si">{</span><span class="n">what</span><span class="si">}</span><span class="s1">&quot;)]&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">how</span> <span class="o">==</span> <span class="n">HOWS</span><span class="p">[</span><span class="s1">&#39;tag_name&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return arguments[0].closest(`$</span><span class="si">{arguments[1]}</span><span class="s1">`);&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">what</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">how</span> <span class="o">==</span> <span class="n">HOWS</span><span class="p">[</span><span class="s1">&#39;xpath&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;xpath=./ancestor-or-self::</span><span class="si">{</span><span class="n">what</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpydrElement.copy_and_paste"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.copy_and_paste">[docs]</a>    <span class="k">def</span> <span class="nf">copy_and_paste</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copy text to clipboard and paste it (send_keys) to the element. (Chrome only)</span>

<span class="sd">        Args:</span>
<span class="sd">            text (str): Text to paste</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spydr</span><span class="o">.</span><span class="n">copy_to_clipboard</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">paste_from_clipboard</span><span class="p">()</span></div>

<div class="viewcode-block" id="SpydrElement.css_property"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.css_property">[docs]</a>    <span class="k">def</span> <span class="nf">css_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The value of CSS property.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): CSS property name</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: CSS property value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_of_css_property</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpydrElement.ctrl_click"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.ctrl_click">[docs]</a>    <span class="k">def</span> <span class="nf">ctrl_click</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ctrl-click the element.&quot;&quot;&quot;</span>
        <span class="n">control</span> <span class="o">=</span> <span class="n">Keys</span><span class="o">.</span><span class="n">CONTROL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_actions</span><span class="p">()</span><span class="o">.</span><span class="n">key_down</span><span class="p">(</span><span class="n">control</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">key_up</span><span class="p">(</span><span class="n">control</span><span class="p">)</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">current_url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The element&#39;s current URL.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: URL</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">current_url</span>

<div class="viewcode-block" id="SpydrElement.double_click"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.double_click">[docs]</a>    <span class="k">def</span> <span class="nf">double_click</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Double-click the element.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_actions</span><span class="p">()</span><span class="o">.</span><span class="n">move_to_element</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">double_click</span><span class="p">()</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span></div>

<div class="viewcode-block" id="SpydrElement.double_click_with_offset"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.double_click_with_offset">[docs]</a>    <span class="k">def</span> <span class="nf">double_click_with_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Double-click the element from x and y offsets.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            x_offset (int): X offset from the left of the element. Defaults to 1.</span>
<span class="sd">            y_offset (int): Y offset from the top of the element. Defaults to 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_actions</span><span class="p">()</span><span class="o">.</span><span class="n">move_to_element_with_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">)</span><span class="o">.</span><span class="n">double_click</span><span class="p">()</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span></div>

<div class="viewcode-block" id="SpydrElement.find_element"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.find_element">[docs]</a>    <span class="nd">@_WebElementSpydrify</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">find_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Find the element by the given locator.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str): The locator to identify the element</span>

<span class="sd">        Returns:</span>
<span class="sd">            WebElement: The element found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">how</span><span class="p">,</span> <span class="n">what</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_locator</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">how</span><span class="p">,</span> <span class="n">what</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpydrElement.find_elements"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.find_elements">[docs]</a>    <span class="nd">@_WebElementSpydrify</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">find_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Find all elements by the given locator.</span>

<span class="sd">        Args:</span>
<span class="sd">            locator (str): The locator to identify the elements</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[WebElement]: All elements found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">how</span><span class="p">,</span> <span class="n">what</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_locator</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">how</span><span class="p">,</span> <span class="n">what</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="nd">@_WebElementSpydrify</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">first_child</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the first child element.</span>

<span class="sd">        Returns:</span>
<span class="sd">            WebElement: The first child element of the current element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return arguments[0].firstElementChild;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="SpydrElement.focus"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.focus">[docs]</a>    <span class="k">def</span> <span class="nf">focus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Trigger focus event on the element.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;arguments[0].focus();&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpydrElement.get_attribute"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.get_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">get_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the given attribute or property of the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): Attribute name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpydrElement.get_property"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.get_property">[docs]</a>    <span class="k">def</span> <span class="nf">get_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the given property of the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): Property name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpydrElement.has_attribute"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.has_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">has_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if the element has the given attribute.</span>

<span class="sd">        Args:</span>
<span class="sd">            attribute (str): Attribute name</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the attribute exists</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return arguments[0].hasAttribute(arguments[1]);&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpydrElement.has_attribute_value"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.has_attribute_value">[docs]</a>    <span class="k">def</span> <span class="nf">has_attribute_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if the element&#39;s attribute contains the given `value`.</span>

<span class="sd">        Args:</span>
<span class="sd">            attribute (str): Attribute name</span>
<span class="sd">            value (bool/str): value to check</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether value is found in the element&#39;s attribute</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Attribute value can only be None, Boolean, or String</span>
        <span class="n">attribute_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">attribute_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attribute_value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">attribute_value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span> <span class="o">==</span> <span class="n">attribute_value</span></div>

<div class="viewcode-block" id="SpydrElement.has_class"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.has_class">[docs]</a>    <span class="k">def</span> <span class="nf">has_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if the element has the given CSS class.</span>

<span class="sd">        Args:</span>
<span class="sd">            class_name (str): CSS class name</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the CSS class exists</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return arguments[0].classList.contains(arguments[1]);&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">class_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpydrElement.has_text"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.has_text">[docs]</a>    <span class="k">def</span> <span class="nf">has_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check if the element contains the given `text`.</span>

<span class="sd">        Args:</span>
<span class="sd">            text (str): Text to check</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element has the given text</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">text</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span></div>

<div class="viewcode-block" id="SpydrElement.hide"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.hide">[docs]</a>    <span class="k">def</span> <span class="nf">hide</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Hide the element.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;arguments[0].style.display = &quot;none&quot;;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpydrElement.highlight"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.highlight">[docs]</a>    <span class="k">def</span> <span class="nf">highlight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hex_color</span><span class="o">=</span><span class="s1">&#39;#ff3&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Highlight the element with the given color.</span>

<span class="sd">        Args:</span>
<span class="sd">            hex_color (str, optional): Hex color. Defaults to &#39;#ff3&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;arguments[0].style.backgroundColor = `$</span><span class="si">{arguments[1]}</span><span class="s1">`;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">hex_color</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">html</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The element&#39;s `innerHTML`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: innerHTML</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerHTML&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">html_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The ID of the element.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Element&#39;s ID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Internal ID used by selenium.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Internal WebElement ID</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">id</span>

<div class="viewcode-block" id="SpydrElement.is_displayed"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.is_displayed">[docs]</a>    <span class="k">def</span> <span class="nf">is_displayed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Whether the element is visible to a user.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element is visible</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">is_displayed</span><span class="p">()</span></div>

<div class="viewcode-block" id="SpydrElement.is_enabled"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.is_enabled">[docs]</a>    <span class="k">def</span> <span class="nf">is_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;whether the element is enabled.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element is enabled</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">is_enabled</span><span class="p">()</span></div>

<div class="viewcode-block" id="SpydrElement.is_selected"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.is_selected">[docs]</a>    <span class="k">def</span> <span class="nf">is_selected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Whether the element is selected.</span>

<span class="sd">        Can be used to check if a checkbox or radio button is selected.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element is selected</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">is_selected</span><span class="p">()</span></div>

<div class="viewcode-block" id="SpydrElement.is_text_matched"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.is_text_matched">[docs]</a>    <span class="k">def</span> <span class="nf">is_text_matched</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Whether the given text matches the elememnt&#39;s text.</span>

<span class="sd">        Args:</span>
<span class="sd">            text (str): Text to match</span>

<span class="sd">        Returns:</span>
<span class="sd">             bool: Whether the given text matches</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">text</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span></div>

<div class="viewcode-block" id="SpydrElement.js_click"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.js_click">[docs]</a>    <span class="k">def</span> <span class="nf">js_click</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Call `HTMLElement.click()` using JavaScript.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;arguments[0].click();&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpydrElement.js_send_keys"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.js_send_keys">[docs]</a>    <span class="k">def</span> <span class="nf">js_send_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send text to input using JavaScript.</span>

<span class="sd">        Args:</span>
<span class="sd">            text (str): Text to send</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">            let element = arguments[0];</span>
<span class="s1">            let text = arguments[1];</span>
<span class="s1">            element.value += text;</span>
<span class="s1">            element.dispatchEvent(new Event(&#39;keydown&#39;, {bubbles: true}));</span>
<span class="s1">            element.dispatchEvent(new Event(&#39;keypress&#39;, {bubbles: true}));</span>
<span class="s1">            element.dispatchEvent(new Event(&#39;input&#39;, {bubbles: true}));</span>
<span class="s1">            element.dispatchEvent(new Event(&#39;keyup&#39;, {bubbles: true}));                              </span>
<span class="s1">        &#39;&#39;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="nd">@_WebElementSpydrify</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">last_child</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the last child element.</span>

<span class="sd">        Returns:</span>
<span class="sd">            WebElement: The last child element of the current element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return arguments[0].lastElementChild;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">location</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The location of the element in the renderable canvas.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The coordonate of the element as dict: {&#39;x&#39;: 0, &#39;y&#39;: 0}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">location</span>

    <span class="nd">@property</span>
    <span class="nd">@_WebElementSpydrify</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">next_element</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the next element.</span>

<span class="sd">        Returns:</span>
<span class="sd">            WebElement: The next element of the current element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return arguments[0].nextElementSibling;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@_WebElementSpydrify</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">parent_element</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the parent element.</span>

<span class="sd">        Returns:</span>
<span class="sd">            WebElement: The parent element of the current element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return arguments[0].parentElement;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="SpydrElement.paste_from_clipboard"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.paste_from_clipboard">[docs]</a>    <span class="k">def</span> <span class="nf">paste_from_clipboard</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Paste clipboard (send_keys) to the element. (Chrome only)&quot;&quot;&quot;</span>
        <span class="n">system</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">system</span> <span class="o">==</span> <span class="s1">&#39;Darwin&#39;</span><span class="p">:</span>
            <span class="n">control</span> <span class="o">=</span> <span class="n">Keys</span><span class="o">.</span><span class="n">COMMAND</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">control</span> <span class="o">=</span> <span class="n">Keys</span><span class="o">.</span><span class="n">CONTROL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="nd">@_WebElementSpydrify</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">previous_element</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the previous element.</span>

<span class="sd">        Returns:</span>
<span class="sd">            WebElement: The previous element of the current element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return arguments[0].previousElementSibling;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A dictionary with the size and location of the element.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The size and location of the element as dict: {&#39;x&#39;: 0, &#39;y&#39;: 0, &#39;width&#39;: 100, &#39;height&#39;: 100}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">rect</span>

<div class="viewcode-block" id="SpydrElement.right_click"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.right_click">[docs]</a>    <span class="k">def</span> <span class="nf">right_click</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Right-click on the element.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_actions</span><span class="p">()</span><span class="o">.</span><span class="n">move_to_element</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">context_click</span><span class="p">()</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span></div>

<div class="viewcode-block" id="SpydrElement.right_click_with_offset"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.right_click_with_offset">[docs]</a>    <span class="k">def</span> <span class="nf">right_click_with_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_offset</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_offset</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Right-click on the element with x and y offsets.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            x_offset (int): X offset from the left of the element. Defaults to 1.</span>
<span class="sd">            y_offset (int): Y offset from the top of the element. Defaults to 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_actions</span><span class="p">()</span><span class="o">.</span><span class="n">move_to_element_with_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_offset</span><span class="p">,</span> <span class="n">y_offset</span><span class="p">)</span><span class="o">.</span><span class="n">context_click</span><span class="p">()</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span></div>

<div class="viewcode-block" id="SpydrElement.remove_attribute"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.remove_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">remove_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove the given attribute from the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            attribute (str): Attribute name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">            var element = arguments[0];</span>
<span class="s1">            var attributeName = arguments[1];</span>
<span class="s1">            if (element.hasAttribute(attributeName)) {</span>
<span class="s1">                element.removeAttribute(attributeName);</span>
<span class="s1">            }</span>
<span class="s1">        &#39;&#39;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpydrElement.remove_class"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.remove_class">[docs]</a>    <span class="k">def</span> <span class="nf">remove_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove the given CSS class to the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            class_name (str): CSS class name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return arguments[0].classList.remove(arguments[1]);&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">class_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpydrElement.save_screenshot"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.save_screenshot">[docs]</a>    <span class="k">def</span> <span class="nf">save_screenshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save a screenshot of the element to filename (PNG).</span>

<span class="sd">        Default directory for saved screenshots is defined in: screen_root.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename (str): Filename of the screenshot</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the file is saved</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">screenshot</span><span class="p">(</span><span class="n">Utils</span><span class="o">.</span><span class="n">to_abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spydr</span><span class="o">.</span><span class="n">screen_root</span><span class="p">))</span></div>

<div class="viewcode-block" id="SpydrElement.scroll_into_view"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.scroll_into_view">[docs]</a>    <span class="k">def</span> <span class="nf">scroll_into_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">behavior</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">block</span><span class="o">=</span><span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Scroll the element&#39;s parent to be displayed.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            behavior (str): Defines the transition animation. One of `auto` or `smooth`. Defaults to &#39;auto&#39;.</span>
<span class="sd">            block (str): Defines vertical alignment. One of `start`, `center`, `end`, or `nearest`. Defaults to &#39;start&#39;.</span>
<span class="sd">            inline (str): Defines horizontal alignment. One of `start`, `center`, `end`, or `nearest`. Defaults to &#39;nearest&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">behaviors</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;smooth&#39;</span><span class="p">)</span>
        <span class="n">positions</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;start&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="s1">&#39;nearest&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spydr</span><span class="o">.</span><span class="n">browser</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;ie&#39;</span><span class="p">,</span> <span class="s1">&#39;safari&#39;</span><span class="p">):</span>
            <span class="n">align_to_top</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="n">block</span> <span class="o">==</span> <span class="s1">&#39;end&#39;</span> <span class="k">else</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;arguments[0].scrollIntoView(arguments[1]);&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">align_to_top</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">behavior</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">behaviors</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">WebDriverException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Behavior is not one of </span><span class="si">{</span><span class="n">behaviors</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">behavior</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">block</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">WebDriverException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Block is not one of </span><span class="si">{</span><span class="n">positions</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">block</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">inline</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">WebDriverException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Inline is not one of </span><span class="si">{</span><span class="n">positions</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">inline</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span>
                <span class="s1">&#39;arguments[0].scrollIntoView({ behavior: arguments[1], block: arguments[2], inline: arguments[3] });&#39;</span><span class="p">,</span>
                <span class="bp">self</span><span class="p">,</span> <span class="n">behavior</span><span class="p">,</span> <span class="n">block</span><span class="p">,</span> <span class="n">inline</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpydrElement.scroll_to"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.scroll_to">[docs]</a>    <span class="k">def</span> <span class="nf">scroll_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Scroll the elment to the given x- and y-coordinates. (IE not supported)</span>

<span class="sd">        Args:</span>
<span class="sd">            x (int): x-coordinate</span>
<span class="sd">            y (int): y-coordinate</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;arguments[0].scrollTo(arguments[1], arguments[2]);&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">))</span></div>

<div class="viewcode-block" id="SpydrElement.select_options"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.select_options">[docs]</a>    <span class="nd">@_WebElementSpydrify</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">select_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_by</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">filter_value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get options of an select element.  Filter the options by attribute if `filter_value` is given.</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            filter_by (str): Filter options by attribute. Defaults to &#39;value&#39;.</span>
<span class="sd">            filter_value (str): Filter option&#39;s attribute by value. Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            InvalidSelectorException: Raise an error when element is not a select element</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[WebElement]: All filtered options</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag_name</span> <span class="o">!=</span> <span class="s1">&#39;select&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSelectorException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Element is not a select: </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="s1">&#39;tag_name=option&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">filter_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">opt</span> <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">options</span> <span class="k">if</span> <span class="n">opt</span><span class="o">.</span><span class="n">has_attribute_value</span><span class="p">(</span><span class="n">filter_by</span><span class="p">,</span> <span class="n">filter_value</span><span class="p">)]</span>

        <span class="k">return</span> <span class="n">options</span></div>

<div class="viewcode-block" id="SpydrElement.selected_options"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.selected_options">[docs]</a>    <span class="nd">@_WebElementSpydrify</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">selected_options</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get select element&#39;s `selectedOptions`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            WebDriverException: Raise an error if the element is not a select element.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[WebElement]: All selected options</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag_name</span> <span class="o">==</span> <span class="s1">&#39;select&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;selectedOptions&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">WebDriverException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;WebElement is not a select: </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpydrElement.send_keys"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.send_keys">[docs]</a>    <span class="k">def</span> <span class="nf">send_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">keys</span><span class="p">,</span> <span class="n">blur</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">wait_until_enabled</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Simulate typing into the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            *keys: Any combinations of strings</span>

<span class="sd">        Keyword Arguments:</span>
<span class="sd">            blur (bool): Lose focus after sending keys. Defaults to False.</span>
<span class="sd">            wait_until_enabled (bool): Whether to wait until the element `is_enabled()` before sending keys. Defaults to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">wait_until_enabled</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spydr</span><span class="o">.</span><span class="n">wait_until_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="o">*</span><span class="n">keys</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">blur</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">blur</span><span class="p">()</span></div>

<div class="viewcode-block" id="SpydrElement.set_attribute"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.set_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">set_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the given value to the attribute of the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            attribute (str): Attribute name</span>
<span class="sd">            value (str): Attribute name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">            var element = arguments[0];</span>
<span class="s1">            var attribute = arguments[1];</span>
<span class="s1">            var value = arguments[2];</span>
<span class="s1">            element.setAttribute(attribute, value);</span>
<span class="s1">        &#39;&#39;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpydrElement.show"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show the element.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;arguments[0].style.display = &quot;&quot;;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The size of the element.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The size of the element as dict: {&#39;width&#39;: 100, &#39;height&#39;: 100}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">size</span>

<div class="viewcode-block" id="SpydrElement.submit"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.submit">[docs]</a>    <span class="k">def</span> <span class="nf">submit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Submit a form.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">submit</span><span class="p">()</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tag_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the element&#39;s tagName.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: tagName</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">tag_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The the element&#39;s text. (Only works when the element is in the viewport)</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The text of the element</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">text_content</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the element&#39;s text. (Works whether the element is in the viewport or not)</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The text of the element</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return arguments[0].textContent;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="nd">@text_content</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">text_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text_</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return arguments[0].textContent = `$</span><span class="si">{arguments[1]}</span><span class="s1">`;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">text_</span><span class="p">)</span>

<div class="viewcode-block" id="SpydrElement.toggle_attribute"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.toggle_attribute">[docs]</a>    <span class="k">def</span> <span class="nf">toggle_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Toggle a Boolean attribute. (IE not supported)</span>

<span class="sd">        Args:</span>
<span class="sd">            name ([type]): Attribute name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return arguments[0].toggleAttribute(arguments[1]);&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpydrElement.toggle_class"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.toggle_class">[docs]</a>    <span class="k">def</span> <span class="nf">toggle_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Toggole the given CSS class of the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            class_name (str): CSS class name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;return arguments[0].classList.toggle(arguments[1]);&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">class_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpydrElement.trigger"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.trigger">[docs]</a>    <span class="k">def</span> <span class="nf">trigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Trigger the given event on the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            event (str): Event name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">            var element = arguments[0];</span>
<span class="s1">            var eventName = arguments[1];</span>
<span class="s1">            var event = new Event(eventName, {&quot;bubbles&quot;: false, &quot;cancelable&quot;: false});</span>
<span class="s1">            element.dispatchEvent(event);</span>
<span class="s1">        &#39;&#39;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the value of the element.</span>

<span class="sd">        Args:</span>
<span class="sd">            typecast: Typecast the value. Defaults to `str`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The value, by `typecast`, of the element</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_property</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="SpydrElement.wait_until_displayed"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.wait_until_displayed">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_displayed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until the element is displayed.</span>

<span class="sd">        Keyword Args:</span>
<span class="sd">            timeout (int, optional): Wait timeout. Defaults to Spydr driver timeout.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element is displayed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_displayed</span><span class="p">(),</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpydrElement.wait_until_not_displayed"><a class="viewcode-back" href="../../source/spydr.html#spydr.webdriver.SpydrElement.wait_until_not_displayed">[docs]</a>    <span class="k">def</span> <span class="nf">wait_until_not_displayed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wait until the element is not displayed.</span>

<span class="sd">        Keyword Args:</span>
<span class="sd">            timeout (int, optional): Wait timeout. Defaults to Spydr driver timeout.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the element is not displayed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_until</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_displayed</span><span class="p">(),</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ActionChains</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_locator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locator</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">spydr</span><span class="o">.</span><span class="n">_parse_locator</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_wait_until</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">timeout</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span> <span class="k">if</span> <span class="n">timeout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">spydr</span><span class="o">.</span><span class="n">timeout</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">spydr</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;outerHTML&#39;</span><span class="p">)</span></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">spydr 0.4.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">spydr.webdriver</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Aaron Chen.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.2.
    </div>
  </body>
</html>